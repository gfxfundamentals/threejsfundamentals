<!DOCTYPE html>
<!-- this file is auto-generated from threejs/lessons/threejs-load-gltf.md. Do not edited directly -->
<!--
Copyright 2018, Google Inc.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of Google Inc. nor the names of their
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Loading a .GLTF File" />
<meta name="keywords" content="webgl graphics three.js" />
<meta name="thumbnail" content="https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-load-gltf_en.jpg" />

<meta property="og:title" content="Three.js Loading a .GLTF File" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-load-gltf_en.jpg" />
<meta property="og:description" content="Loading a .GLTF File" />
<meta property="og:url" content="https://threejsfundamentals.org/threejs/lessons/threejs-load-gltf.html" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@greggman" />
<meta name="twitter:creator" content="@greggman" />
<meta name="twitter:domain" content="threejsfundamentals.org" />
<meta name="twitter:title" content="Three.js Loading a .GLTF File" />
<meta name="twitter:url" content="https://threejsfundamentals.org/threejs/lessons/threejs-load-gltf.html" />
<meta name="twitter:description" content="Loading a .GLTF File" />
<meta name="twitter:image:src" content="https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-load-gltf_en.jpg" />

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://threejsfundamentals.org/#website",
      "url":"https://threejsfundamentals.org/",
      "name":"ThreejsFundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://threejsfundamentals.org/threejs/lessons/threejs-load-gltf.html#primaryimage",
      "url":"https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-load-gltf_en.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://threejsfundamentals.org/threejs/lessons/threejs-load-gltf.html#webpage",
      "url":"https://threejsfundamentals.org/threejs/lessons/threejs-load-gltf.html",
      "inLanguage":"en",
      "name":"Three.js Loading a .GLTF File",
      "keywords":"webgl graphics three.js programming",
      "isPartOf":{
        "@id":"https://threejsfundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://threejsfundamentals.org/threejs/lessons/threejs-load-gltf.html#primaryimage"
      }
    }
  ]
}
</script>

<title>Three.js Loading a .GLTF File</title>
<link href="/threejs/lessons/resources/threejsfundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="apple-touch-icon" href="/threejs/lessons/resources/threejsfundamentals-icon.png">
<link rel="icon" href="/threejs/lessons/resources/threejsfundamentals-icon.png">

<link rel="stylesheet" href="/threejs/lessons/lang.css" />
<link rel="stylesheet" href="/threejs/lessons/resources/lesson.css" />
</head>
<body>
<div class="threejs_navbar">
  <div>
    <select class="language">
    <option value="/threejs/lessons/threejs-load-gltf.html" selected>English</a>
    <option value="/threejs/lessons/fr/threejs-load-gltf.html" >Fran√ßais</a>
    <option value="/threejs/lessons/ja/threejs-load-gltf.html" >Êó•Êú¨Ë™û</a>
    <option value="/threejs/lessons/kr/threejs-load-gltf.html" >ÌïúÍµ≠Ïñ¥</a>
    <option value="/threejs/lessons/ru/threejs-load-gltf.html" >–†—É—Å—Å–∫–∏–π</a>
    <option value="/threejs/lessons/zh_cn/threejs-load-gltf.html" >‰∏≠Êñá</a>
</select>


    <a href="#toc">Table of Contents</a>
  </div>
</div>
<div class="threejs_header">
  <h1><a href="/">threejsfundamentals.org</a></h1>
<style>
#forkongithub a {
    background: #000;
    color: #fff;
    text-decoration: none;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 2rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 300px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(150px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a:hover {
    background: #c11;
    color: #fff;
}
#forkongithub a::before,#forkongithub a::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub a::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
@media (max-width: 900px) {
    #forkongithub a{
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub a{
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><a href="https://github.com/gfxfundamentals/threejsfundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>Three.js Loading a .GLTF File</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>In a previous lesson we <a href="threejs-load-obj.html">loaded an .OBJ file</a>. If
you haven&#39;t read it you might want to check it out first.</p>
<p>As pointed out over there the .OBJ file format is very old and fairly
simple. It provides no scene graph so everything loaded is one large
mesh. It was designed mostly as a simple way to pass data between
3D editors.</p>
<p><a href="https://github.com/KhronosGroup/glTF">The gLTF format</a> is actually
a format designed from the ground up for be used for displaying
graphics. 3D formats can be divided into 3 or 4 basic types.</p>
<ul>
<li><p>3D Editor Formats</p>
<p>This are formats specific to a single app. .blend (Blender), .max (3d Studio Max),
.mb and .ma (Maya), etc...</p>
</li>
<li><p>Exchange formats</p>
<p>These are formats like .OBJ, .DAE (Collada), .FBX. They are designed to help exchange
information between 3D editors. As such they are usually much larger than needed with
extra info used only inside 3d editors</p>
</li>
<li><p>App formats</p>
<p>These are usually specific to certain apps, usually games.</p>
</li>
<li><p>Transmission formats</p>
<p>gLTF might be the first true transmission format. I suppose VRML might be considered
one but VRML was actually a pretty poor format.</p>
<p>gLTF is designed to do some things well that all those other formats don&#39;t do</p>
<ol>
<li><p>Be small for transmission</p>
<p>For example this means much of their large data, like vertices, is stored in
binary. When you download a .gLTF file that data can be uploaded to the GPU
with zero processing. It&#39;s ready as is. This is in contrast to say VRML, .OBJ,
or .DAE where vertices are stored as text and have to be parsed. Text vertex
positions can easily be 3x to 5x larger than binary.</p>
</li>
<li><p>Be ready to render</p>
<p>This again is different from other formats except maybe App formats. The data
in a glTF file is mean to be rendered, not edited. Data that&#39;s not important to
rendering has generally been removed. Polygons have been converted to triangles.
Materials have known values that are supposed to work everywhere.</p>
</li>
</ol>
</li>
</ul>
<p>gLTF was specifically designed so you should be able to download a glTF file and
display it with a minimum of trouble. Let&#39;s cross our fingers that&#39;s truly the case
as none of the other formats have been able to do this.</p>
<p>I wasn&#39;t really sure what I should show. At some level loading and displaying a gLTF file
is simpler than an .OBJ file. Unlike a .OBJ file materials are directly part of the format.
That said I thought I should at least load one up and I think going over the issues I ran 
into might provide some good info.</p>
<p>Searching the net I found <a href="https://sketchfab.com/models/edd1c604e1e045a0a2a552ddd9a293e6">this low-poly city</a>
by <a href="https://sketchfab.com/antonmoek">antonmoek</a> which seemed like if we&#39;re lucky
might make a good example.</p>
<div class="threejs_center"><img src="resources/images/cartoon_lowpoly_small_city_free_pack.jpg"></div>

<p>Starting with <a href="threejs-load-obj.html">an example from the .OBJ article</a> I removed the code
for loading .OBJ and replaced it with code for loading .GLTF</p>
<p>The old .OBJ code was</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const objLoader = new OBJLoader2();
objLoader.loadMtl(&#39;resources/models/windmill/windmill-fixed.mtl&#39;, null, (materials) =&gt; {
  materials.Material.side = THREE.DoubleSide;
  objLoader.setMaterials(materials);
  objLoader.load(&#39;resources/models/windmill/windmill.obj&#39;, (event) =&gt; {
    const root = event.detail.loaderRootNode;
    scene.add(root);
    ...
  });
});
</code></pre>
<p>The new .GLTF code is</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">{
  const gltfLoader = new GLTFLoader();
  const url = &#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;;
  gltfLoader.load(url, (gltf) =&gt; {
    const root = gltf.scene;
    scene.add(root);
    ...
  });
</code></pre>
<p>I kept the auto framing code as before</p>
<p>We also need to include the <code class="notranslate" translate="no">GLTFLoader</code> and we can get rid of the <code class="notranslate" translate="no">OBJLoader2</code>.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-html">-import {LoaderSupport} from &#39;./resources/threejs/r119/examples/jsm/loaders/LoaderSupport.js&#39;;
-import {OBJLoader2} from &#39;./resources/threejs/r119/examples/jsm/loaders/OBJLoader2.js&#39;;
-import {MTLLoader} from &#39;./resources/threejs/r119/examples/jsm/loaders/MTLLoader.js&#39;;
+import {GLTFLoader} from &#39;./resources/threejs/r119/examples/jsm/loaders/GLTFLoader.js&#39;;
</code></pre>
<p>And running that we get</p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf.html" target="_blank">click here to open in a separate window</a>
</div>

</p>
<p>Magic! It just works, textures and all.</p>
<p>Next I wanted to see if I could animate the cars driving around so
I needed to check if the scene had the cars as separate entities
and if they were setup in a way I could use them.</p>
<p>I wrote some code to dump put the scenegraph to the <a href="threejs-debugging-javascript.html">JavaScript
console</a>.</p>
<p>Here&#39;s the code to print out the scenegraph.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">function dumpObject(obj, lines = [], isLast = true, prefix = &#39;&#39;) {
  const localPrefix = isLast ? &#39;‚îî‚îÄ&#39; : &#39;‚îú‚îÄ&#39;;
  lines.push(`${prefix}${prefix ? localPrefix : &#39;&#39;}${obj.name || &#39;*no-name*&#39;} [${obj.type}]`);
  const newPrefix = prefix + (isLast ? &#39;  &#39; : &#39;‚îÇ &#39;);
  const lastNdx = obj.children.length - 1;
  obj.children.forEach((child, ndx) =&gt; {
    const isLast = ndx === lastNdx;
    dumpObject(child, lines, isLast, newPrefix);
  });
  return lines;
}
</code></pre>
<p>And I just called it right after loading the scene.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const gltfLoader = new GLTFLoader();
gltfLoader.load(&#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;, (gltf) =&gt; {
  const root = gltf.scene;
  scene.add(root);
  console.log(dumpObject(root).join(&#39;\n&#39;));
</code></pre>
<p><a href="../threejs-load-gltf-dump-scenegraph.html">Running that</a> I got this listing</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-text">OSG_Scene [Scene]
  ‚îî‚îÄRootNode_(gltf_orientation_matrix) [Object3D]
    ‚îî‚îÄRootNode_(model_correction_matrix) [Object3D]
      ‚îî‚îÄ4d4100bcb1c640e69699a87140df79d7fbx [Object3D]
        ‚îî‚îÄRootNode [Object3D]
          ‚îÇ ...
          ‚îú‚îÄCars [Object3D]
          ‚îÇ ‚îú‚îÄCAR_03_1 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCAR_03_1_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCAR_03 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCAR_03_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_04 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_04_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCAR_03_2 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCAR_03_2_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_04_1 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_04_1_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_04_2 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_04_2_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_04_3 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_04_3_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_04_4 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_04_4_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_08_4 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_08_4_World_ap8_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_08_3 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_08_3_World_ap9_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_04_1_2 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_04_1_2_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_08_2 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_08_2_World_ap11_0 [Mesh]
          ‚îÇ ‚îú‚îÄCAR_03_1_2 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCAR_03_1_2_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCAR_03_2_2 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCAR_03_2_2_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_04_2_2 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_04_2_2_World_ap_0 [Mesh]
          ...
</code></pre>
<p>From that we can see all the cars happen to be under a parent
called <code class="notranslate" translate="no">&quot;Cars&quot;</code></p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-text">*          ‚îú‚îÄCars [Object3D]
          ‚îÇ ‚îú‚îÄCAR_03_1 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCAR_03_1_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCAR_03 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCAR_03_World_ap_0 [Mesh]
          ‚îÇ ‚îú‚îÄCar_04 [Object3D]
          ‚îÇ ‚îÇ ‚îî‚îÄCar_04_World_ap_0 [Mesh]
</code></pre>
<p>So as a simple test I thought I would just try rotating
all the children of the &quot;Cars&quot; node around their Y axis.</p>
<p>I looked up the &quot;Cars&quot; node after loading the scene
and saved the result.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">+let cars;
{
  const gltfLoader = new GLTFLoader();
  gltfLoader.load(&#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;, (gltf) =&gt; {
    const root = gltf.scene;
    scene.add(root);
+    cars = root.getObjectByName(&#39;Cars&#39;);
</code></pre>
<p>Then in the <code class="notranslate" translate="no">render</code> function we can just set the rotation
of each child of <code class="notranslate" translate="no">cars</code>.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">+function render(time) {
+  time *= 0.001;  // convert to seconds

  if (resizeRendererToDisplaySize(renderer)) {
    const canvas = renderer.domElement;
    camera.aspect = canvas.clientWidth / canvas.clientHeight;
    camera.updateProjectionMatrix();
  }

+  if (cars) {
+    for (const car of cars.children) {
+      car.rotation.y = time;
+    }
+  }

  renderer.render(scene, camera);

  requestAnimationFrame(render);
}
</code></pre>
<p>And we get</p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf-rotate-cars.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf-rotate-cars.html" target="_blank">click here to open in a separate window</a>
</div>

</p>
<p>Hmmm, it looks like unfortunately this scene wasn&#39;t designed to
animate the cars as their origins are not setup for that purpose.
The trucks are rotating in the wrong direction.</p>
<p>This brings up an important point which is if you&#39;re going to
do something in 3D you need to plan ahead and design your assets
so they have their origins in the correct places, so they are
the correct scale, etc.</p>
<p>Since I&#39;m not an artist and I don&#39;t know blender that well I
will hack this example. We&#39;ll take each car and parent it to
another <code class="notranslate" translate="no">Object3D</code>. We will then move those <code class="notranslate" translate="no">Object3D</code> objects
to move the cars but separately we can set the car&#39;s original
<code class="notranslate" translate="no">Object3D</code> to re-orient it so it&#39;s about where we really need it.</p>
<p>Looking back at the scene graph listing it looks like there
are really only 3 types of cars, &quot;Car_08&quot;, &quot;CAR_03&quot;, and &quot;Car_04&quot;.
Hopefully each type of car will work with the same adjustments.</p>
<p>I wrote this code to go through each car, parent it to a new
<code class="notranslate" translate="no">Object3D</code>, parent that new <code class="notranslate" translate="no">Object3D</code> to the scene, and apply
some per car <em>type</em> settings to fix its orientation, and add
the new <code class="notranslate" translate="no">Object3D</code> a <code class="notranslate" translate="no">cars</code> array.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">-let cars;
+const cars = [];
{
  const gltfLoader = new GLTFLoader();
  gltfLoader.load(&#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;, (gltf) =&gt; {
    const root = gltf.scene;
    scene.add(root);

-    cars = root.getObjectByName(&#39;Cars&#39;);
+    const loadedCars = root.getObjectByName(&#39;Cars&#39;);
+    const fixes = [
+      { prefix: &#39;Car_08&#39;, rot: [Math.PI * .5, 0, Math.PI +* .5], },
+      { prefix: &#39;CAR_03&#39;, rot: [0, Math.PI, 0], },
+      { prefix: &#39;Car_04&#39;, rot: [0, Math.PI, 0], },
+    ];
+
+    root.updateMatrixWorld();
+    for (const car of loadedCars.children.slice()) {
+      const fix = fixes.find(fix =&gt; car.name.startsWith(fix.prefix));
+      const obj = new THREE.Object3D();
+      car.getWorldPosition(obj.position);
+      car.position.set(0, 0, 0);
+      car.rotation.set(...fix.rot);
+      obj.add(car);
+      scene.add(obj);
+      cars.push(obj);
+    }
     ...
</code></pre>
<p>This fixes the orientation of the cars. </p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf-rotate-cars-fixed.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf-rotate-cars-fixed.html" target="_blank">click here to open in a separate window</a>
</div>

</p>
<p>Now let&#39;s drive them around.</p>
<p>Making even a simple driving system is too much for this post but
it seems instead we could just make one convoluted path that
drives down all the roads and then put the cars on the path.
Here&#39;s a picture from Blender about half way through building
the path.</p>
<div class="threejs_center"><img src="resources/images/making-path-for-cars.jpg" style="width: 1094px"></div>

<p>I needed a way to get the data for that path out of Blender.
Fortunately I was able to select just my path and export .OBJ checking &quot;write nurbs&quot;.</p>
<div class="threejs_center"><img src="resources/images/blender-export-obj-write-nurbs.jpg" style="width: 498px"></div>

<p>Opening the .OBJ file I was able to get a list of points
which I formatted into this</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const controlPoints = [
  [1.118281, 5.115846, -3.681386],
  [3.948875, 5.115846, -3.641834],
  [3.960072, 5.115846, -0.240352],
  [3.985447, 5.115846, 4.585005],
  [-3.793631, 5.115846, 4.585006],
  [-3.826839, 5.115846, -14.736200],
  [-14.542292, 5.115846, -14.765865],
  [-14.520929, 5.115846, -3.627002],
  [-5.452815, 5.115846, -3.634418],
  [-5.467251, 5.115846, 4.549161],
  [-13.266233, 5.115846, 4.567083],
  [-13.250067, 5.115846, -13.499271],
  [4.081842, 5.115846, -13.435463],
  [4.125436, 5.115846, -5.334928],
  [-14.521364, 5.115846, -5.239871],
  [-14.510466, 5.115846, 5.486727],
  [5.745666, 5.115846, 5.510492],
  [5.787942, 5.115846, -14.728308],
  [-5.423720, 5.115846, -14.761919],
  [-5.373599, 5.115846, -3.704133],
  [1.004861, 5.115846, -3.641834],
];
</code></pre>
<p>THREE.js has some curve classes. The <code class="notranslate" translate="no">CatmullRomCurve3</code> seemed
like it might work. The thing about that kind of curve is
it tries to make a smooth curve going through the points.</p>
<p>In fact putting those points in directly will generate
a curve like this</p>
<div class="threejs_center"><img src="resources/images/car-curves-before.png" style="width: 400px"></div>

<p>but we want a sharper corners. It seemed like if we computed
some extra points we could get what we want. For each pair
of points we&#39;ll compute a point 10% of the way between
the 2 points and another 90% of the way between the 2 points
and pass the result to <code class="notranslate" translate="no">CatmullRomCurve3</code>.</p>
<p>This will give us a curve like this</p>
<div class="threejs_center"><img src="resources/images/car-curves-after.png" style="width: 400px"></div>

<p>Here&#39;s the code to make the curve </p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">let curve;
let curveObject;
{
  const controlPoints = [
    [1.118281, 5.115846, -3.681386],
    [3.948875, 5.115846, -3.641834],
    [3.960072, 5.115846, -0.240352],
    [3.985447, 5.115846, 4.585005],
    [-3.793631, 5.115846, 4.585006],
    [-3.826839, 5.115846, -14.736200],
    [-14.542292, 5.115846, -14.765865],
    [-14.520929, 5.115846, -3.627002],
    [-5.452815, 5.115846, -3.634418],
    [-5.467251, 5.115846, 4.549161],
    [-13.266233, 5.115846, 4.567083],
    [-13.250067, 5.115846, -13.499271],
    [4.081842, 5.115846, -13.435463],
    [4.125436, 5.115846, -5.334928],
    [-14.521364, 5.115846, -5.239871],
    [-14.510466, 5.115846, 5.486727],
    [5.745666, 5.115846, 5.510492],
    [5.787942, 5.115846, -14.728308],
    [-5.423720, 5.115846, -14.761919],
    [-5.373599, 5.115846, -3.704133],
    [1.004861, 5.115846, -3.641834],
  ];
  const p0 = new THREE.Vector3();
  const p1 = new THREE.Vector3();
  curve = new THREE.CatmullRomCurve3(
    controlPoints.map((p, ndx) =&gt; {
      p0.set(...p);
      p1.set(...controlPoints[(ndx + 1) % controlPoints.length]);
      return [
        (new THREE.Vector3()).copy(p0),
        (new THREE.Vector3()).lerpVectors(p0, p1, 0.1),
        (new THREE.Vector3()).lerpVectors(p0, p1, 0.9),
      ];
    }).flat(),
    true,
  );
  {
    const points = curve.getPoints(250);
    const geometry = new THREE.BufferGeometry().setFromPoints(points);
    const material = new THREE.LineBasicMaterial({color: 0xff0000});
    curveObject = new THREE.Line(geometry, material);
    scene.add(curveObject);
  }
}
</code></pre>
<p>The first part of that code makes a curve.
The second part of that code generates 250 points
from the curve and then creates an object to display
the lines made by connecting those 250 points.</p>
<p>Running <a href="../threejs-load-gltf-car-path.html">the example</a> I didn&#39;t see
the curve. To make it visible I made it ignore the depth test and
render last</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">    curveObject = new THREE.Line(geometry, material);
+    material.depthTest = false;
+    curveObject.renderOrder = 1;
</code></pre>
<p>And that&#39;s when I discovered it was way too small.</p>
<div class="threejs_center"><img src="resources/images/car-curves-too-small.png" style="width: 498px"></div>

<p>Checking the hierarchy in Blender I found out that the artist had
scaled the node all the cars are parented to.</p>
<div class="threejs_center"><img src="resources/images/cars-scale-0.01.png" style="width: 342px;"></div>

<p>Scaling is bad for real time 3D apps. It causes all kinds of
issues and ends up being no end of frustration when doing
real time 3D. Artists often don&#39;t know this because it&#39;s so
easy to scale an entire scene in a 3D editing program but
if you decide to make a real time 3D app I suggest you request your
artists to never scale anything. If they change the scale
they should find a way to apply that scale to the vertices
so that when it ends up making it to your app you can ignore
scale.</p>
<p>And, not just scale, in this case the cars are rotated and offset
by their parent, the <code class="notranslate" translate="no">Cars</code> node. This will make it hard at runtime
to move the cars around in world space. To be clear, in this case
we want cars to drive around in world space which is why these
issues are coming up. If something that is meant to be manipulated
in a local space, like the moon revolving around the earth this
is less of an issue.</p>
<p>Going back to the function we wrote above to dump the scene graph,
let&#39;s dump the position, rotation, and scale of each node.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">+function dumpVec3(v3, precision = 3) {
+  return `${v3.x.toFixed(precision)}, ${v3.y.toFixed(precision)}, ${v3.z.toFixed(precision)}`;
+}

function dumpObject(obj, lines, isLast = true, prefix = &#39;&#39;) {
  const localPrefix = isLast ? &#39;‚îî‚îÄ&#39; : &#39;‚îú‚îÄ&#39;;
  lines.push(`${prefix}${prefix ? localPrefix : &#39;&#39;}${obj.name || &#39;*no-name*&#39;} [${obj.type}]`);
+  const dataPrefix = obj.children.length
+     ? (isLast ? &#39;  ‚îÇ &#39; : &#39;‚îÇ ‚îÇ &#39;)
+     : (isLast ? &#39;    &#39; : &#39;‚îÇ   &#39;);
+  lines.push(`${prefix}${dataPrefix}  pos: ${dumpVec3(obj.position)}`);
+  lines.push(`${prefix}${dataPrefix}  rot: ${dumpVec3(obj.rotation)}`);
+  lines.push(`${prefix}${dataPrefix}  scl: ${dumpVec3(obj.scale)}`);
  const newPrefix = prefix + (isLast ? &#39;  &#39; : &#39;‚îÇ &#39;);
  const lastNdx = obj.children.length - 1;
  obj.children.forEach((child, ndx) =&gt; {
    const isLast = ndx === lastNdx;
    dumpObject(child, lines, isLast, newPrefix);
  });
  return lines;
}
</code></pre>
<p>And the result from <a href="../threejs-load-gltf-dump-scenegraph-extra.html">running it</a></p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-text">OSG_Scene [Scene]
  ‚îÇ   pos: 0.000, 0.000, 0.000
  ‚îÇ   rot: 0.000, 0.000, 0.000
  ‚îÇ   scl: 1.000, 1.000, 1.000
  ‚îî‚îÄRootNode_(gltf_orientation_matrix) [Object3D]
    ‚îÇ   pos: 0.000, 0.000, 0.000
    ‚îÇ   rot: -1.571, 0.000, 0.000
    ‚îÇ   scl: 1.000, 1.000, 1.000
    ‚îî‚îÄRootNode_(model_correction_matrix) [Object3D]
      ‚îÇ   pos: 0.000, 0.000, 0.000
      ‚îÇ   rot: 0.000, 0.000, 0.000
      ‚îÇ   scl: 1.000, 1.000, 1.000
      ‚îî‚îÄ4d4100bcb1c640e69699a87140df79d7fbx [Object3D]
        ‚îÇ   pos: 0.000, 0.000, 0.000
        ‚îÇ   rot: 1.571, 0.000, 0.000
        ‚îÇ   scl: 1.000, 1.000, 1.000
        ‚îî‚îÄRootNode [Object3D]
          ‚îÇ   pos: 0.000, 0.000, 0.000
          ‚îÇ   rot: 0.000, 0.000, 0.000
          ‚îÇ   scl: 1.000, 1.000, 1.000
          ‚îú‚îÄCars [Object3D]
*          ‚îÇ ‚îÇ   pos: -369.069, -90.704, -920.159
*          ‚îÇ ‚îÇ   rot: 0.000, 0.000, 0.000
*          ‚îÇ ‚îÇ   scl: 1.000, 1.000, 1.000
          ‚îÇ ‚îú‚îÄCAR_03_1 [Object3D]
          ‚îÇ ‚îÇ ‚îÇ   pos: 22.131, 14.663, -475.071
          ‚îÇ ‚îÇ ‚îÇ   rot: -3.142, 0.732, 3.142
          ‚îÇ ‚îÇ ‚îÇ   scl: 1.500, 1.500, 1.500
          ‚îÇ ‚îÇ ‚îî‚îÄCAR_03_1_World_ap_0 [Mesh]
          ‚îÇ ‚îÇ       pos: 0.000, 0.000, 0.000
          ‚îÇ ‚îÇ       rot: 0.000, 0.000, 0.000
          ‚îÇ ‚îÇ       scl: 1.000, 1.000, 1.000
</code></pre>
<p>This shows us that <code class="notranslate" translate="no">Cars</code> in the original scene has had its rotation and scale
removed and applied to its children. That suggests either whatever exporter was
used to create the .GLTF file did some special work here or more likely the
artist exported a different version of the file than the corresponding .blend
file, which is why things don&#39;t match.</p>
<p>The moral of that is I should have probably downloaded the .blend
file and exported myself. Before exporting I should have inspected
all the major nodes and removed any transformations.</p>
<p>All these nodes at the top</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-text">OSG_Scene [Scene]
  ‚îÇ   pos: 0.000, 0.000, 0.000
  ‚îÇ   rot: 0.000, 0.000, 0.000
  ‚îÇ   scl: 1.000, 1.000, 1.000
  ‚îî‚îÄRootNode_(gltf_orientation_matrix) [Object3D]
    ‚îÇ   pos: 0.000, 0.000, 0.000
    ‚îÇ   rot: -1.571, 0.000, 0.000
    ‚îÇ   scl: 1.000, 1.000, 1.000
    ‚îî‚îÄRootNode_(model_correction_matrix) [Object3D]
      ‚îÇ   pos: 0.000, 0.000, 0.000
      ‚îÇ   rot: 0.000, 0.000, 0.000
      ‚îÇ   scl: 1.000, 1.000, 1.000
      ‚îî‚îÄ4d4100bcb1c640e69699a87140df79d7fbx [Object3D]
        ‚îÇ   pos: 0.000, 0.000, 0.000
        ‚îÇ   rot: 1.571, 0.000, 0.000
        ‚îÇ   scl: 1.000, 1.000, 1.000
</code></pre>
<p>are also a waste.</p>
<p>Ideally the scene would consist of a single &quot;root&quot; node with no position,
rotation, or scale. At runtime I could then pull all the children out of that
root and parent them to the scene itself. There might be children of the root
like &quot;Cars&quot; which would help me find all the cars but ideally it would also have
no translation, rotation, or scale so I could re-parent the cars to the scene
with the minimal amount of work.</p>
<p>In any case the quickest though maybe not the best fix is to just
adjust the object we&#39;re using to view the curve.</p>
<p>Here&#39;s what I ended up with.</p>
<p>First I adjusted the position of the curve and found values
that seemed to work. I then hid it.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">{
  const points = curve.getPoints(250);
  const geometry = new THREE.BufferGeometry().setFromPoints(points);
  const material = new THREE.LineBasicMaterial({color: 0xff0000});
  curveObject = new THREE.Line(geometry, material);
+  curveObject.scale.set(100, 100, 100);
+  curveObject.position.y = -621;
+  curveObject.visible = false;
  material.depthTest = false;
  curveObject.renderOrder = 1;
  scene.add(curveObject);
}
</code></pre>
<p>Then I wrote code to move the cars along the curve. For each car we pick a
position from 0 to 1 along the curve and compute a point in world space using
the <code class="notranslate" translate="no">curveObject</code> to transform the point. We then pick another point slightly
further down the curve. We set the car&#39;s orientation using <code class="notranslate" translate="no">lookAt</code> and put the
car at the mid point between the 2 points.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">// create 2 Vector3s we can use for path calculations
const carPosition = new THREE.Vector3();
const carTarget = new THREE.Vector3();

function render(time) {
  ...

-  for (const car of cars) {
-    car.rotation.y = time;
-  }

+  {
+    const pathTime = time * .01;
+    const targetOffset = 0.01;
+    cars.forEach((car, ndx) =&gt; {
+      // a number between 0 and 1 to evenly space the cars
+      const u = pathTime + ndx / cars.length;
+
+      // get the first point
+      curve.getPointAt(u % 1, carPosition);
+      carPosition.applyMatrix4(curveObject.matrixWorld);
+
+      // get a second point slightly further down the curve
+      curve.getPointAt((u + targetOffset) % 1, carTarget);
+      carTarget.applyMatrix4(curveObject.matrixWorld);
+
+      // put the car at the first point (temporarily)
+      car.position.copy(carPosition);
+      // point the car the second point
+      car.lookAt(carTarget);
+
+      // put the car between the 2 points
+      car.position.lerpVectors(carPosition, carTarget, 0.5);
+    });
+  }
</code></pre>
<p>and when I ran it I found out for each type of car, their height above their origins
are not consistently set and so I needed to offset each one
a little.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const loadedCars = root.getObjectByName(&#39;Cars&#39;);
const fixes = [
-  { prefix: &#39;Car_08&#39;, rot: [Math.PI * .5, 0, Math.PI * .5], },
-  { prefix: &#39;CAR_03&#39;, rot: [0, Math.PI, 0], },
-  { prefix: &#39;Car_04&#39;, rot: [0, Math.PI, 0], },
+  { prefix: &#39;Car_08&#39;, y: 0,  rot: [Math.PI * .5, 0, Math.PI * .5], },
+  { prefix: &#39;CAR_03&#39;, y: 33, rot: [0, Math.PI, 0], },
+  { prefix: &#39;Car_04&#39;, y: 40, rot: [0, Math.PI, 0], },
];

root.updateMatrixWorld();
for (const car of loadedCars.children.slice()) {
  const fix = fixes.find(fix =&gt; car.name.startsWith(fix.prefix));
  const obj = new THREE.Object3D();
  car.getWorldPosition(obj.position);
-  car.position.set(0, 0, 0);
+  car.position.set(0, fix.y, 0);
  car.rotation.set(...fix.rot);
  obj.add(car);
  scene.add(obj);
  cars.push(obj);
}
</code></pre>
<p>And the result.</p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf-animated-cars.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf-animated-cars.html" target="_blank">click here to open in a separate window</a>
</div>

</p>
<p>Not bad for a few minutes work.</p>
<p>The last thing I wanted to do is turn on shadows.</p>
<p>To do this I grabbed all the GUI code from the <code class="notranslate" translate="no">DirectionalLight</code> shadows
example in <a href="threejs-shadows.html">the article on shadows</a> and pasted it
into our latest code.</p>
<p>Then, after loading, we need to turn on shadows on all the objects.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">{
  const gltfLoader = new GLTFLoader();
  gltfLoader.load(&#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;, (gltf) =&gt; {
    const root = gltf.scene;
    scene.add(root);

+    root.traverse((obj) =&gt; {
+      if (obj.castShadow !== undefined) {
+        obj.castShadow = true;
+        obj.receiveShadow = true;
+      }
+    });
</code></pre>
<p>I then spent nearly 4 hours trying to figure out why the shadow helpers
were not working. It was because I forgot to enable shadows with</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">renderer.shadowMap.enabled = true;
</code></pre>
<p>üò≠</p>
<p>I then adjusted the values until our <code class="notranslate" translate="no">DirectionLight</code>&#39;s shadow camera
had a frustum that covered the entire scene. These are the settings
I ended up with.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">{
  const color = 0xFFFFFF;
  const intensity = 1;
  const light = new THREE.DirectionalLight(color, intensity);
+  light.castShadow = true;
*  light.position.set(-250, 800, -850);
*  light.target.position.set(-550, 40, -450);

+  light.shadow.bias = -0.004;
+  light.shadow.mapSize.width = 2048;
+  light.shadow.mapSize.height = 2048;

  scene.add(light);
  scene.add(light.target);
+  const cam = light.shadow.camera;
+  cam.near = 1;
+  cam.far = 2000;
+  cam.left = -1500;
+  cam.right = 1500;
+  cam.top = 1500;
+  cam.bottom = -1500;
...
</code></pre>
<p>and I set the background color to light blue.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const scene = new THREE.Scene();
-scene.background = new THREE.Color(&#39;black&#39;);
+scene.background = new THREE.Color(&#39;#DEFEFF&#39;);
</code></pre>
<p>And ... shadows</p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf-shadows.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf-shadows.html" target="_blank">click here to open in a separate window</a>
</div>

</p>
<p>I hope walking through this project was useful and showed some
good examples of working though some of the issues of loading
a file with a scenegraph.</p>
<p>One interesting thing is that comparing the .blend file to the .gltf
file, the .blend file has several lights but they are not lights
after being loaded into the scene. A .GLTF file is just a JSON
file so you can easily look inside. It consists of several
arrays of things and each item in an array is referenced by index
else where. While there are extensions in the works they point
to a problem with almost all 3d formats. <strong>They can never cover every
case</strong>.</p>
<p>There is always a need for more data. For example we manually exported
a path for the cars to follow. Ideally that info could have been in
the .GLTF file but to do that we&#39;d need to write our own exporter
and some how mark nodes for how we want them exported or use a
naming scheme or something along those lines to get data from
whatever tool we&#39;re using to create the data into our app.</p>
<p>All of that is left as an exercise to the reader.</p>

    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/threejs/lessons/threejs-load-gltf.html" selected>English</a>
    <option value="/threejs/lessons/fr/threejs-load-gltf.html" >Fran√ßais</a>
    <option value="/threejs/lessons/ja/threejs-load-gltf.html" >Êó•Êú¨Ë™û</a>
    <option value="/threejs/lessons/kr/threejs-load-gltf.html" >ÌïúÍµ≠Ïñ¥</a>
    <option value="/threejs/lessons/ru/threejs-load-gltf.html" >–†—É—Å—Å–∫–∏–π</a>
    <option value="/threejs/lessons/zh_cn/threejs-load-gltf.html" >‰∏≠Êñá</a>
</select>


        <div id="toc">
          <ul>  <li>Basics</li>
        <ul>
          <li><a href="/threejs/lessons/threejs-fundamentals.html">Fundamentals</a></li>
<li><a href="/threejs/lessons/threejs-responsive.html">Responsive Design</a></li>
<li><a href="/threejs/lessons/threejs-prerequisites.html">Prerequisites</a></li>
<li><a href="/threejs/lessons/threejs-setup.html">Setup</a></li>
        </ul>
  <li>Fundamentals</li>
        <ul>
          <li><a href="/threejs/lessons/threejs-primitives.html">Primitives</a></li>
<li><a href="/threejs/lessons/threejs-scenegraph.html">Scenegraph</a></li>
<li><a href="/threejs/lessons/threejs-materials.html">Materials</a></li>
<li><a href="/threejs/lessons/threejs-textures.html">Textures</a></li>
<li><a href="/threejs/lessons/threejs-lights.html">Lights</a></li>
<li><a href="/threejs/lessons/threejs-cameras.html">Cameras</a></li>
<li><a href="/threejs/lessons/threejs-shadows.html">Shadows</a></li>
<li><a href="/threejs/lessons/threejs-fog.html">Fog</a></li>
<li><a href="/threejs/lessons/threejs-rendertargets.html">Render Targets</a></li>
<li><a href="/threejs/lessons/threejs-custom-geometry.html">Custom Geometry</a></li>
<li><a href="/threejs/lessons/threejs-custom-buffergeometry.html">Custom BufferGeometry</a></li>
        </ul>
  <li>Tips</li>
        <ul>
          <li><a href="/threejs/lessons/threejs-rendering-on-demand.html">Rendering On Demand</a></li>
<li><a href="/threejs/lessons/threejs-debugging-javascript.html">Debugging JavaScript</a></li>
<li><a href="/threejs/lessons/threejs-debugging-glsl.html">Debugging GLSL</a></li>
<li><a href="/threejs/lessons/threejs-tips.html#screenshot">Taking a screenshot</a></li>
<li><a href="/threejs/lessons/threejs-tips.html#preservedrawingbuffer">Prevent the Canvas Being Cleared</a></li>
<li><a href="/threejs/lessons/threejs-tips.html#tabindex">Get Keyboard Input From a Canvas</a></li>
<li><a href="/threejs/lessons/threejs-tips.html#transparent-canvas">Make the Canvas Transparent</a></li>
<li><a href="/threejs/lessons/threejs-tips.html#html-background">Use three.js as Background in HTML</a></li>
        </ul>
  <li>Optimization</li>
        <ul>
          <li><a href="/threejs/lessons/threejs-optimize-lots-of-objects.html">Optimizing Lots of Objects</a></li>
<li><a href="/threejs/lessons/threejs-optimize-lots-of-objects-animated.html">Optimizing Lots of Objects Animated</a></li>
<li><a href="/threejs/lessons/threejs-offscreencanvas.html">Using OffscreenCanvas in a Web Worker</a></li>
        </ul>
  <li>Solutions</li>
        <ul>
          <li><a href="/threejs/lessons/threejs-load-obj.html">Load an .OBJ file</a></li>
<li><a href="/threejs/lessons/threejs-load-gltf.html">Load a .GLTF file</a></li>
<li><a href="/threejs/lessons/threejs-backgrounds.html">Add a Background or Skybox</a></li>
<li><a href="/threejs/lessons/threejs-transparency.html">How to Draw Transparent Objects</a></li>
<li><a href="/threejs/lessons/threejs-multiple-scenes.html">Multiple Canvases, Multiple Scenes</a></li>
<li><a href="/threejs/lessons/threejs-picking.html">Picking Objects with the mouse</a></li>
<li><a href="/threejs/lessons/threejs-post-processing.html">Post Processing</a></li>
<li><a href="/threejs/lessons/threejs-post-processing-3dlut.html">Applying a LUT File for effects</a></li>
<li><a href="/threejs/lessons/threejs-shadertoy.html">Using Shadertoy shaders</a></li>
<li><a href="/threejs/lessons/threejs-align-html-elements-to-3d.html">Aligning HTML Elements to 3D</a></li>
<li><a href="/threejs/lessons/threejs-indexed-textures.html">Using Indexed Textures for Picking and Color</a></li>
<li><a href="/threejs/lessons/threejs-canvas-textures.html">Using A Canvas for Dynamic Textures</a></li>
<li><a href="/threejs/lessons/threejs-billboards.html">Billboards and Facades</a></li>
<li><a href="/threejs/lessons/threejs-cleanup.html">Freeing Resources</a></li>
<li><a href="/threejs/lessons/threejs-voxel-geometry.html">Making Voxel Geometry (Minecraft)</a></li>
<li><a href="/threejs/lessons/threejs-game.html">Start making a Game.</a></li>
        </ul>
  <li>WebVR</li>
        <ul>
          <li><a href="/threejs/lessons/threejs-webvr.html">VR - Basics</a></li>
<li><a href="/threejs/lessons/threejs-webvr-look-to-select.html">VR - Look To Select</a></li>
<li><a href="/threejs/lessons/threejs-webvr-point-to-select.html">VR - Point To Select</a></li>
        </ul>
  <li>Reference</li>
        <ul>
          <li><a href="/threejs/lessons/threejs-material-table.html">Material Table</a></li>
        </ul></ul>
<ul>
  <li><a href="https://github.com/gfxfundamentals/threejsfundamentals">github</a></li>
  <li><a href="https://threejs.org">three.js</a></li>
  <li><a href="https://threejs.org/docs/">three.js docs</a></li>
</ul>

        </div>
    </div>
    <div class="lesson-comments">
        
    <div>Questions? <a href="http://stackoverflow.com/questions/tagged/three.js">Ask on stackoverflow</a>.</div>
    <div>
       <a href="https://github.com/gfxfundamentals/threejsfundamentals/issues/new?assignees=&labels=suggested+topic&template=suggest-topic.md&title=%5BSUGGESTION%5D">Suggestion</a>?
       <a href="https://github.com/gfxfundamentals/threejsfundamentals/issues/new?assignees=&labels=&template=request.md&title=">Request</a>?
       <a href="https://github.com/gfxfundamentals/threejsfundamentals/issues/new?assignees=&labels=bug+%2F+issue&template=bug-issue-report.md&title=">Issue</a>?
       <a href="https://github.com/gfxfundamentals/threejsfundamentals/issues/new?assignees=&labels=bug+%2F+issue&template=bug-issue-report.md&title=">Bug</a>?
    </div>
    <div class="lesson-comment-notes">
       Use <b>&lt;pre&gt;&lt;code&gt;</b>code goes here<b>&lt;/code&gt;&lt;/pre&gt;</b> for code blocks
    </div>
  

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'threejsfundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'Three.js Loading a .GLTF File';
            var disqus_title = 'Three.js Loading a .GLTF File';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("threejsfundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script src="/3rdparty/jquery-3.3.1.slim.min.js"></script>
<script src="/threejs/lessons/resources/prettify.js"></script>
<script src="/threejs/lessons/resources/lesson.js"></script>
<script>
(function() {
  if (window.location.hostname.indexOf("threejsfundamentals.org") < 0) {
      return;
  }

  function addScript(src, fn) {
    const script = document.createElement('script');
    const firstScript = document.getElementsByTagName('script')[0];
    script.async = true;
    script.defer = true;
    if (fn) {
      script.addEventListener('load', fn);
    }
    script.src = src;
    firstScript.parentNode.insertBefore(script, firstScript);
  }

  addScript('//cdn.webglstats.com/stat.js');
  addScript('https://www.googletagmanager.com/gtag/js?id=UA-120733518-1', () => {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-120733518-1');
  });
}());
</script>


</html>



