<!DOCTYPE html>
<!-- this file is auto-generated from threejs/lessons/ja/threejs-load-gltf.md. Do not edited directly -->
<!--
Copyright 2018, Google Inc.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of Google Inc. nor the names of their
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="GLTFãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿">
<meta name="keywords" content="webgl graphics three.js">
<meta name="thumbnail" content="https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-load-gltf_ja.jpg">

<meta property="og:title" content="Three.jsã§GLFTãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€">
<meta property="og:type" content="website">
<meta property="og:image" content="https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-load-gltf_ja.jpg">
<meta property="og:description" content="GLTFãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿">
<meta property="og:url" content="https://threejsfundamentals.org/threejs/lessons/ja/threejs-load-gltf.html">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@greggman">
<meta name="twitter:creator" content="@greggman">
<meta name="twitter:domain" content="threejsfundamentals.org">
<meta name="twitter:title" content="Three.jsã§GLFTãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€">
<meta name="twitter:url" content="https://threejsfundamentals.org/threejs/lessons/ja/threejs-load-gltf.html">
<meta name="twitter:description" content="GLTFãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿">
<meta name="twitter:image:src" content="https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-load-gltf_ja.jpg">

  <link rel="alternate" hreflang="en" href="https://webglfundamentals.org/threejs/lessons/threejs-load-gltf.html">
  <link rel="alternate" hreflang="fr" href="https://webglfundamentals.org/threejs/lessons/fr/threejs-load-gltf.html">
  <link rel="alternate" hreflang="ja" href="https://webglfundamentals.org/threejs/lessons/ja/threejs-load-gltf.html">
  <link rel="alternate" hreflang="kr" href="https://webglfundamentals.org/threejs/lessons/kr/threejs-load-gltf.html">
  <link rel="alternate" hreflang="ru" href="https://webglfundamentals.org/threejs/lessons/ru/threejs-load-gltf.html">
  <link rel="alternate" hreflang="zh_cn" href="https://webglfundamentals.org/threejs/lessons/zh_cn/threejs-load-gltf.html">




<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://threejsfundamentals.org/#website",
      "url":"https://threejsfundamentals.org/",
      "name":"ThreejsFundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://threejsfundamentals.org/threejs/lessons/ja/threejs-load-gltf.html#primaryimage",
      "url":"https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-load-gltf_ja.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://threejsfundamentals.org/threejs/lessons/ja/threejs-load-gltf.html#webpage",
      "url":"https://threejsfundamentals.org/threejs/lessons/ja/threejs-load-gltf.html",
      "inLanguage":"ja",
      "name":"Three.jsã§GLFTãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€",
      "keywords":"webgl graphics three.js programming",
      "isPartOf":{
        "@id":"https://threejsfundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://threejsfundamentals.org/threejs/lessons/ja/threejs-load-gltf.html#primaryimage"
      }
    }
  ]
}
</script>

<title>Three.jsã§GLFTãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€</title>
<link href="/threejs/lessons/resources/threejsfundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="apple-touch-icon" href="/threejs/lessons/resources/threejsfundamentals-icon.png">
<link rel="icon" href="/threejs/lessons/resources/threejsfundamentals-icon.png">

<link rel="stylesheet" href="/threejs/lessons/lang.css">
<link rel="stylesheet" href="/threejs/lessons/resources/lesson.css">
</head>
<body>
<div class="threejs_navbar">
  <div>
    <select class="language">
    <option value="/threejs/lessons/threejs-load-gltf.html" >English</a>
    <option value="/threejs/lessons/fr/threejs-load-gltf.html" >FranÃ§ais</a>
    <option value="/threejs/lessons/ja/threejs-load-gltf.html" selected>æ—¥æœ¬èª</a>
    <option value="/threejs/lessons/kr/threejs-load-gltf.html" >í•œêµ­ì–´</a>
    <option value="/threejs/lessons/ru/threejs-load-gltf.html" >Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
    <option value="/threejs/lessons/zh_cn/threejs-load-gltf.html" >ä¸­æ–‡</a>
</select>


    <a href="#toc">ç›®æ¬¡</a>
  </div>
</div>
<div class="threejs_header">
  <h1><a href="/threejs/lessons/ja/">threejsfundamentals.org</a></h1>
<style>
#forkongithub a {
    background: #000;
    color: #fff;
    text-decoration: none;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 2rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 300px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(150px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a:hover {
    background: #c11;
    color: #fff;
}
#forkongithub a::before,#forkongithub a::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub a::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
@media (max-width: 900px) {
    #forkongithub a{
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub a{
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><a href="https://github.com/gfxfundamentals/threejsfundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>Three.jsã§GLFTãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>å‰å›ã®ãƒ¬ãƒƒã‚¹ãƒ³ã¯<a href="threejs-load-obj.html">OBJãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿</a>ã§ã—ãŸã€‚
ã¾ã èª­ã‚“ã§ã„ãªã„æ–¹ã¯ã€ã¾ãšãã¡ã‚‰ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚</p>
<p>å‰å›ã®è¨˜äº‹ã§æŒ‡æ‘˜ã—ãŸã‚ˆã†ã«ã€OBJãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯éå¸¸ã«å¤ãã‹ãªã‚Šå˜ç´”ã§ã™ã€‚
OBJã‹ã‚‰èª­ã¿è¾¼ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã¯ã‚·ãƒ¼ãƒ³ã‚°ãƒ©ãƒ•ã‚’æä¾›ã—ãªã„ãŸã‚ã€å…¨ã¦1ã¤ã®å¤§ããªãƒ¡ãƒƒã‚·ãƒ¥ã«ãªã‚Šã¾ã™ã€‚
OBJã¯3Dã‚¨ãƒ‡ã‚£ã‚¿é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™å˜ç´”ãªæ–¹æ³•ã¨ã—ã¦è¨­è¨ˆã•ã‚Œã¾ã—ãŸã€‚</p>
<p><a href="https://github.com/KhronosGroup/glTF">gLTFãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</a>ã¯ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚
3Dãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯åŸºæœ¬çš„ã«3ï½4ç¨®é¡ã«åˆ†ã‘ã‚‰ã‚Œã¾ã™ã€‚</p>
<ul>
<li><p>3Dã‚¨ãƒ‡ã‚£ã‚¿ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</p>
<p>ã“ã‚Œã¯1ã¤ã®ã‚¢ãƒ—ãƒªå›ºæœ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚.blend (Blender)ã€.max (3d Studio Max)ã€.mbã€.ma (Maya) ãªã©ã€‚</p>
</li>
<li><p>äº¤æ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</p>
<p>ã“ã‚Œã¯OBJã€DAEï¼ˆColladaï¼‰ã€FBXã®ã‚ˆã†ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚
3Dã‚¨ãƒ‡ã‚£ã‚¿é–“ã®æƒ…å ±äº¤æ›ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯é€šå¸¸ã¯3Dã‚¨ãƒ‡ã‚£ã‚¿ã®å†…éƒ¨ã§ã®ã¿ä½¿ç”¨ã•ã‚Œã‚‹è¿½åŠ æƒ…å ±ã‚’æŒã¡ã€å¿…è¦ä»¥ä¸Šã«å¤§ãããªã‚Šã¾ã™ã€‚</p>
</li>
<li><p>ã‚¢ãƒ—ãƒªã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</p>
<p>ç‰¹å®šã®ã‚¢ãƒ—ãƒªã€é€šå¸¸ã¯ã‚²ãƒ¼ãƒ ã«ç‰¹åŒ–ã—ãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚</p>
</li>
<li><p>ä¼é€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</p>
<p>gLTFã¯åˆã‚ã¦ã®ä¼é€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
VRMLã‚‚ä¼é€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€VRMLã¯ã‹ãªã‚Šè²§å¼±ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã—ãŸã€‚</p>
<p>gLTFã¯ä»–ã®å…¨ã¦ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã¯ã§ããªã„ã€ä»¥ä¸‹ã®äº‹ãŒã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<ol>
<li><p>ä¼é€ã‚’å°ã•ãã™ã‚‹</p>
<p>é ‚ç‚¹ã®ã‚ˆã†ãªå¤§ããªãƒ‡ãƒ¼ã‚¿ã®å¤šããŒãƒã‚¤ãƒŠãƒªã§ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚
gLTFãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ™‚ã€ã‚¼ãƒ­å‡¦ç†ã§GPUã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚
ãã®æ©Ÿèƒ½ã¯ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚
VRMLã€OBJã€ã¾ãŸã¯DAEãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ˆã†ã«é ‚ç‚¹ãŒãƒ†ã‚­ã‚¹ãƒˆã§ä¿å­˜ã•ã‚Œã€è§£æãŒå¿…è¦ã§ã‚ã‚‹äº‹ã¨ã¯å¯¾ç…§çš„ã§ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆã®é ‚ç‚¹ä½ç½®ã¯ãƒã‚¤ãƒŠãƒªã‚ˆã‚Šã‚‚3å€ã‹ã‚‰5å€ã®å¤§ãã•ã§ã™ã€‚</p>
</li>
<li><p>ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®æº–å‚™ãŒã§ãã¦ã„ã‚‹</p>
<p>ã“ã‚Œã‚‚ãŠãã‚‰ãä»–ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆã‚¢ãƒ—ãƒªã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä»¥å¤–ï¼‰ã¨ã¯é•ã„ã¾ã™ã€‚
glTFãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ‡ãƒ¼ã‚¿ã¯ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹äº‹ãŒç›®çš„ã§ã€ç·¨é›†ã•ã‚Œã‚‹äº‹ã¯ç›®çš„ã¨ã—ã¦ã„ã¾ã›ã‚“ã€‚
ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã«é‡è¦ã§ãªã„ãƒ‡ãƒ¼ã‚¿ã¯å‰Šé™¤ã•ã‚Œã¦ã„ã¾ã™ã€‚
ãƒãƒªã‚´ãƒ³ãŒä¸‰è§’å½¢ã«å¤‰æ›ã•ã‚Œã¦ã„ã¾ã™ã€‚
ãƒãƒ†ãƒªã‚¢ãƒ«ã«ã¯ã©ã“ã§ã‚‚å‹•ãã‚ˆã†ã«ã‚µãƒãƒ¼ãƒˆã•ã‚ŒãŸå€¤ã‚’æŒã£ã¦ã„ã¾ã™ã€‚</p>
</li>
</ol>
</li>
</ul>
<p>æœ€ä½é™ã®æ‰‹é–“ã§glTFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ã€ç‰¹åˆ¥ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚
ä»–ã®ã©ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚‚ã“ã‚ŒãŒã§ããªã‹ã£ãŸã®ã§ã€ã“ã®è¨­è¨ˆã¯è‰¯ã„çµæœã«ãªã‚‹ã¨ä¿¡ã˜ã¾ã—ã‚‡ã†ã€‚</p>
<p>ç§ã¯ä½•ã‚’è¦‹ã›ã‚Œã°è‰¯ã„ã®ã‹è¿·ã£ã¦ã„ã¾ã—ãŸã€‚
ã‚ã‚‹ç¨‹åº¦ã®ãƒ¬ãƒ™ãƒ«ã§ã¯gLTFãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã¨è¡¨ç¤ºã¯ã€OBJãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šã‚‚ç°¡å˜ã§ã™ã€‚
OBJã¨ã¯ç•°ãªã‚Šã€gLTFã§ã¯ãƒãƒ†ãƒªã‚¢ãƒ«ã¯ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ç›´æ¥çš„ãªéƒ¨åˆ†ã§ã™ã€‚
å°‘ãªãã¨ã‚‚glTFãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ä¾‹ã‚’è¦‹ã›ã‚‹ã¹ãã§ã€ç§ãŒé­é‡ã—ãŸå•é¡Œã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ã¨çš†ã•ã‚“ãŒè‰¯ã„æƒ…å ±ã‚’å¾—ã‚‰ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã¨æ€ã„ã¾ã—ãŸã€‚</p>
<p>ãƒãƒƒãƒˆã§æ¤œç´¢ã—ãŸã‚‰<a href="https://sketchfab.com/antonmoek">antonmoek</a>ã•ã‚“ã®<a href="https://sketchfab.com/models/edd1c604e1e045a0a2a552ddd9a293e6">ä½ãƒãƒªã‚´ãƒ³ã®ã‚·ãƒ†ã‚£ãƒ¢ãƒ‡ãƒ«</a>ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚
é‹ãŒè‰¯ã‘ã‚Œã°è‰¯ã„ä¾‹ã«ãªã‚‹ã‚ˆã†ã«æ€ãˆã¾ã—ãŸã€‚</p>
<div class="threejs_center"><img src="../resources/images/cartoon_lowpoly_small_city_free_pack.jpg"></div>

<p><a href="threejs-load-obj.html">OBJãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã®ã‚³ãƒ¼ãƒ‰ä¾‹</a>ã‹ã‚‰å§‹ã‚ã¦ã€OBJã‚’èª­ã¿è¾¼ã‚€ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ã—ã€GLTFã‚’èª­ã¿è¾¼ã‚€ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆã¾ã—ãŸã€‚</p>
<p>ä»¥å‰ã®OBJã‚³ãƒ¼ãƒ‰ã¯</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const objLoader = new OBJLoader2();
objLoader.loadMtl(&#39;resources/models/windmill/windmill-fixed.mtl&#39;, null, (materials) =&gt; {
  materials.Material.side = THREE.DoubleSide;
  objLoader.setMaterials(materials);
  objLoader.load(&#39;resources/models/windmill/windmill.obj&#39;, (event) =&gt; {
    const root = event.detail.loaderRootNode;
    scene.add(root);
    ...
  });
});
</code></pre>
<p>æ–°ã—ã„GLTFã®ã‚³ãƒ¼ãƒ‰ã¯</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">{
  const gltfLoader = new GLTFLoader();
  const url = &#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;;
  gltfLoader.load(url, (gltf) =&gt; {
    const root = gltf.scene;
    scene.add(root);
    ...
  });
</code></pre>
<p>è‡ªå‹•ãƒ•ãƒ¬ãƒ¼ãƒŸãƒ³ã‚°ã®ã‚³ãƒ¼ãƒ‰ã¯ä»¥å‰ã®ã¾ã¾ã§ã™ã€‚</p>
<p>ã¾ãŸ <code class="notranslate" translate="no">OBJLoader2</code> ã‚’å–ã‚Šé™¤ã <code class="notranslate" translate="no">GLTFLoader</code> ã‚’å«ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-html">-import {LoaderSupport} from &#39;./resources/threejs/r122/examples/jsm/loaders/LoaderSupport.js&#39;;
-import {OBJLoader2} from &#39;./resources/threejs/r122/examples/jsm/loaders/OBJLoader2.js&#39;;
-import {MTLLoader} from &#39;./resources/threejs/r122/examples/jsm/loaders/MTLLoader.js&#39;;
+import {GLTFLoader} from &#39;./resources/threejs/r122/examples/jsm/loaders/GLTFLoader.js&#39;;
</code></pre>
<p>å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã«ãªã‚Šã¾ã—ãŸã€‚</p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf.html" target="_blank">ã“ã“ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦åˆ¥ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ãã¾ã™</a>
</div>

</p>
<p>é­”æ³•ã ï¼ãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒ¼ã‚‚å«ã‚ã¦ä¸Šæ‰‹ãã„ã£ã¦ã„ã¾ã™ã€‚</p>
<p>æ¬¡ã«èµ°ã‚Šå›ã‚‹è»Šã‚’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã—ãŸã‹ã£ãŸã®ã§ã€ã‚·ãƒ¼ãƒ³ã«è»ŠãŒåˆ¥ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨ã—ã¦è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã€ãã‚ŒãŒä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p><a href="threejs-debugging-javascript.html">JavaScriptã‚³ãƒ³ã‚½ãƒ¼ãƒ«</a>ã«ã‚·ãƒ¼ãƒ³ã‚°ãƒ©ãƒ•ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã¿ã¾ã—ãŸã€‚</p>
<p>ã‚·ãƒ¼ãƒ³ã‚°ãƒ©ãƒ•ã‚’è¡¨ç¤ºã™ã‚‹ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">function dumpObject(obj, lines = [], isLast = true, prefix = &#39;&#39;) {
  const localPrefix = isLast ? &#39;â””â”€&#39; : &#39;â”œâ”€&#39;;
  lines.push(`${prefix}${prefix ? localPrefix : &#39;&#39;}${obj.name || &#39;*no-name*&#39;} [${obj.type}]`);
  const newPrefix = prefix + (isLast ? &#39;  &#39; : &#39;â”‚ &#39;);
  const lastNdx = obj.children.length - 1;
  obj.children.forEach((child, ndx) =&gt; {
    const isLast = ndx === lastNdx;
    dumpObject(child, lines, isLast, newPrefix);
  });
  return lines;
}
</code></pre>
<p>ãã—ã¦ã€ã‚·ãƒ¼ãƒ³ã‚’èª­ã¿è¾¼ã¿ç›´å¾Œã«å‘¼ã³å‡ºã—ã¾ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const gltfLoader = new GLTFLoader();
gltfLoader.load(&#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;, (gltf) =&gt; {
  const root = gltf.scene;
  scene.add(root);
  console.log(dumpObject(root).join(&#39;\n&#39;));
</code></pre>
<p><a href="../../threejs-load-gltf-dump-scenegraph.html">å®Ÿè¡Œã™ã‚‹ã¨</a> ã“ã®ã‚ˆã†ãªãƒªã‚¹ãƒˆãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-text">OSG_Scene [Scene]
  â””â”€RootNode_(gltf_orientation_matrix) [Object3D]
    â””â”€RootNode_(model_correction_matrix) [Object3D]
      â””â”€4d4100bcb1c640e69699a87140df79d7fbx [Object3D]
        â””â”€RootNode [Object3D]
          â”‚ ...
          â”œâ”€Cars [Object3D]
          â”‚ â”œâ”€CAR_03_1 [Object3D]
          â”‚ â”‚ â””â”€CAR_03_1_World_ap_0 [Mesh]
          â”‚ â”œâ”€CAR_03 [Object3D]
          â”‚ â”‚ â””â”€CAR_03_World_ap_0 [Mesh]
          â”‚ â”œâ”€Car_04 [Object3D]
          â”‚ â”‚ â””â”€Car_04_World_ap_0 [Mesh]
          â”‚ â”œâ”€CAR_03_2 [Object3D]
          â”‚ â”‚ â””â”€CAR_03_2_World_ap_0 [Mesh]
          â”‚ â”œâ”€Car_04_1 [Object3D]
          â”‚ â”‚ â””â”€Car_04_1_World_ap_0 [Mesh]
          â”‚ â”œâ”€Car_04_2 [Object3D]
          â”‚ â”‚ â””â”€Car_04_2_World_ap_0 [Mesh]
          â”‚ â”œâ”€Car_04_3 [Object3D]
          â”‚ â”‚ â””â”€Car_04_3_World_ap_0 [Mesh]
          â”‚ â”œâ”€Car_04_4 [Object3D]
          â”‚ â”‚ â””â”€Car_04_4_World_ap_0 [Mesh]
          â”‚ â”œâ”€Car_08_4 [Object3D]
          â”‚ â”‚ â””â”€Car_08_4_World_ap8_0 [Mesh]
          â”‚ â”œâ”€Car_08_3 [Object3D]
          â”‚ â”‚ â””â”€Car_08_3_World_ap9_0 [Mesh]
          â”‚ â”œâ”€Car_04_1_2 [Object3D]
          â”‚ â”‚ â””â”€Car_04_1_2_World_ap_0 [Mesh]
          â”‚ â”œâ”€Car_08_2 [Object3D]
          â”‚ â”‚ â””â”€Car_08_2_World_ap11_0 [Mesh]
          â”‚ â”œâ”€CAR_03_1_2 [Object3D]
          â”‚ â”‚ â””â”€CAR_03_1_2_World_ap_0 [Mesh]
          â”‚ â”œâ”€CAR_03_2_2 [Object3D]
          â”‚ â”‚ â””â”€CAR_03_2_2_World_ap_0 [Mesh]
          â”‚ â”œâ”€Car_04_2_2 [Object3D]
          â”‚ â”‚ â””â”€Car_04_2_2_World_ap_0 [Mesh]
          ...
</code></pre>
<p>ã“ã®çµæœã‹ã‚‰å…¨ã¦ã®è»ŠãŒ <code class="notranslate" translate="no">&quot;Cars&quot;</code> ã¨ã„ã†åå‰ã®è¦ªã®ä¸‹ã«ã‚ã‚‹äº‹ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-text">*          â”œâ”€Cars [Object3D]
          â”‚ â”œâ”€CAR_03_1 [Object3D]
          â”‚ â”‚ â””â”€CAR_03_1_World_ap_0 [Mesh]
          â”‚ â”œâ”€CAR_03 [Object3D]
          â”‚ â”‚ â””â”€CAR_03_World_ap_0 [Mesh]
          â”‚ â”œâ”€Car_04 [Object3D]
          â”‚ â”‚ â””â”€Car_04_World_ap_0 [Mesh]
</code></pre>
<p>ãã“ã§ç°¡å˜ãªãƒ†ã‚¹ãƒˆã¨ã—ã¦ã€&quot;Cars&quot;ãƒãƒ¼ãƒ‰ã®å…¨ã¦ã®å­ã‚’Yè»¸ã®å‘¨ã‚Šã«å›è»¢ã•ã›ã‚ˆã†ã¨æ€ã„ã¾ã—ãŸã€‚</p>
<p>ã‚·ãƒ¼ãƒ³ã‚’èª­ã¿è¾¼ã¿å¾Œã«&quot;Cars&quot;ãƒãƒ¼ãƒ‰ã‚’èª¿ã¹ã¦çµæœã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">+let cars;
{
  const gltfLoader = new GLTFLoader();
  gltfLoader.load(&#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;, (gltf) =&gt; {
    const root = gltf.scene;
    scene.add(root);
+    cars = root.getObjectByName(&#39;Cars&#39;);
</code></pre>
<p><code class="notranslate" translate="no">render</code> é–¢æ•°ã§ <code class="notranslate" translate="no">cars</code> ã®å…¨ã¦ã®å­ã®å›è»¢ã‚’è¨­å®šã—ã¾ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">+function render(time) {
+  time *= 0.001;  // convert to seconds

  if (resizeRendererToDisplaySize(renderer)) {
    const canvas = renderer.domElement;
    camera.aspect = canvas.clientWidth / canvas.clientHeight;
    camera.updateProjectionMatrix();
  }

+  if (cars) {
+    for (const car of cars.children) {
+      car.rotation.y = time;
+    }
+  }

  renderer.render(scene, camera);

  requestAnimationFrame(render);
}
</code></pre>
<p>ã“ã‚ŒãŒçµæœã§ã™ã€‚</p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf-rotate-cars.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf-rotate-cars.html" target="_blank">ã“ã“ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦åˆ¥ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ãã¾ã™</a>
</div>

</p>
<p>ã†ãƒ¼ã‚“ã€æ®‹å¿µãªãŒã‚‰å­ã®ã‚ªãƒªã‚¸ãƒ³ãŒå›è»¢ç›®çš„ã®ãŸã‚ã«è¨­å®šã•ã‚Œã¦ãŠã‚‰ãšã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã«è¨­è¨ˆã•ã‚Œã¦ãªã„ã‚ˆã†ã§ã™ã€‚ãƒˆãƒ©ãƒƒã‚¯ã®å›è»¢æ–¹å‘ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚</p>
<p>3Dã§ä½•ã‹ã™ã‚‹å ´åˆã®é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã¯ã€äº‹å‰ã«è¨ˆç”»ã‚’ç«‹ã¦ã¦ã‚¢ã‚»ãƒƒãƒˆã‚’è¨­è¨ˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚¢ã‚»ãƒƒãƒˆã‚’æ­£ã—ã„å ´æ‰€ã«é…ç½®ã—ã€æ­£ã—ã„ã‚¹ã‚±ãƒ¼ãƒ«ã«ãªã‚‹ã‚ˆã†ã«ãƒ‡ã‚¶ã‚¤ãƒ³ã—ã¾ã™ã€‚</p>
<p>ç§ã¯3DCGã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã§ã¯ãªãBlenderã‚‚ã‚ˆãçŸ¥ã‚‰ãªã„ã®ã§ã€ãƒãƒƒã‚¯ã—ã¦ã¿ã¾ã™ã€‚
ãã‚Œãã‚Œã®è»Šã§åˆ¥ã® <code class="notranslate" translate="no">Object3D</code> ã‚’è¦ªã«ã—ã¾ã™ã€‚
æ¬¡ã« <code class="notranslate" translate="no">Object3D</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç§»å‹•ã•ã›ã¦è»Šã‚’ç§»å‹•ã•ã›ã¾ã™ã€‚
å€‹ã€…ã«è»Šã®ã‚ªãƒªã‚¸ãƒ³ã« <code class="notranslate" translate="no">Object3D</code> ã‚’è¨­å®šã—ã¦å‘ãã‚’å¤‰ãˆã‚‰ã‚Œã‚‹ã®ã§ã€å¿…è¦ãªä½ç½®ã«è¨­å®šã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚</p>
<p>ã‚·ãƒ¼ãƒ³ã‚°ãƒ©ãƒ•ã®ãƒªã‚¹ãƒˆã‚’è¦‹è¿”ã™ã¨ &quot;Car_08&quot;, &quot;CAR_03&quot;, &quot;Car_04&quot; ã®3ç¨®é¡ã—ã‹ãªã„ã‚ˆã†ã§ã™ã€‚ä¸Šæ‰‹ãã„ã‘ã°3ç¨®é¡ã®èª¿æ•´ã§æ¸ˆã¿ã¾ã™ã€‚</p>
<p>ã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚
ãã‚Œãã‚Œã®è»Šã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆã—ãŸ <code class="notranslate" translate="no">Object3D</code> ã‚’è¦ªã«ã—ã€ãã® <code class="notranslate" translate="no">Object3D</code> ã‚’ã‚·ãƒ¼ãƒ³ã«è¿½åŠ ã—ã¾ã™ã€‚
<em>è»Šç¨®</em>ã”ã¨ã®è¨­å®šã§å‘ãã‚’å›ºå®šã—ã€è»Šã®è¦ªã® <code class="notranslate" translate="no">Object3D</code> ã® <code class="notranslate" translate="no">cars</code> é…åˆ—ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">-let cars;
+const cars = [];
{
  const gltfLoader = new GLTFLoader();
  gltfLoader.load(&#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;, (gltf) =&gt; {
    const root = gltf.scene;
    scene.add(root);

-    cars = root.getObjectByName(&#39;Cars&#39;);
+    const loadedCars = root.getObjectByName(&#39;Cars&#39;);
+    const fixes = [
+      { prefix: &#39;Car_08&#39;, rot: [Math.PI * .5, 0, Math.PI +* .5], },
+      { prefix: &#39;CAR_03&#39;, rot: [0, Math.PI, 0], },
+      { prefix: &#39;Car_04&#39;, rot: [0, Math.PI, 0], },
+    ];
+
+    root.updateMatrixWorld();
+    for (const car of loadedCars.children.slice()) {
+      const fix = fixes.find(fix =&gt; car.name.startsWith(fix.prefix));
+      const obj = new THREE.Object3D();
+      car.getWorldPosition(obj.position);
+      car.position.set(0, 0, 0);
+      car.rotation.set(...fix.rot);
+      obj.add(car);
+      scene.add(obj);
+      cars.push(obj);
+    }
     ...
</code></pre>
<p>ã“ã‚Œã§è»Šã®å‘ãã‚’ä¿®æ­£ã—ã¾ã—ãŸã€‚</p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf-rotate-cars-fixed.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf-rotate-cars-fixed.html" target="_blank">ã“ã“ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦åˆ¥ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ãã¾ã™</a>
</div>

</p>
<p>ã•ã‚ã€è¿½ã„å›ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<p>ç°¡å˜ãªãƒ‰ãƒ©ã‚¤ãƒ“ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œã‚‹ã®ã¯ã“ã®è¨˜äº‹ã§ã¯ç„¡ç†ãŒã‚ã‚Šã¾ã™ãŒã€
ãã®ä»£ã‚ã‚Šã«å…¥ã‚Šçµ„ã‚“ã ãƒ‘ã‚¹ã‚’1æœ¬ã«ã—ã€ãã®ãƒ‘ã‚¹ã«è»Šã‚’ä¹—ã›ã‚‹äº‹ãŒã§ããã†ã§ã™ã€‚
ä»¥ä¸‹ã®ç”»åƒã¯Blenderã§ãƒ‘ã‚¹ã‚’ä½œã£ã¦ã„ã‚‹é€”ä¸­ã§ã™ã€‚</p>
<div class="threejs_center"><img src="../resources/images/making-path-for-cars.jpg" style="width: 1094px"></div>

<p>Blenderã‹ã‚‰ãƒ‘ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã™æ–¹æ³•ãŒå¿…è¦ã§ã—ãŸã€‚
å¹¸é‹ãªäº‹ã«ãƒ‘ã‚¹ã ã‘ã‚’é¸æŠã—ã€&quot;write nurbs&quot;ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦objã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§ãã¾ã—ãŸã€‚</p>
<div class="threejs_center"><img src="../resources/images/blender-export-obj-write-nurbs.jpg" style="width: 498px"></div>

<p>OBJãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¨é ‚ç‚¹ã®ãƒªã‚¹ãƒˆã‚’å¾—ã‚‹äº‹ãŒã§ãã¾ã—ãŸã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const controlPoints = [
  [1.118281, 5.115846, -3.681386],
  [3.948875, 5.115846, -3.641834],
  [3.960072, 5.115846, -0.240352],
  [3.985447, 5.115846, 4.585005],
  [-3.793631, 5.115846, 4.585006],
  [-3.826839, 5.115846, -14.736200],
  [-14.542292, 5.115846, -14.765865],
  [-14.520929, 5.115846, -3.627002],
  [-5.452815, 5.115846, -3.634418],
  [-5.467251, 5.115846, 4.549161],
  [-13.266233, 5.115846, 4.567083],
  [-13.250067, 5.115846, -13.499271],
  [4.081842, 5.115846, -13.435463],
  [4.125436, 5.115846, -5.334928],
  [-14.521364, 5.115846, -5.239871],
  [-14.510466, 5.115846, 5.486727],
  [5.745666, 5.115846, 5.510492],
  [5.787942, 5.115846, -14.728308],
  [-5.423720, 5.115846, -14.761919],
  [-5.373599, 5.115846, -3.704133],
  [1.004861, 5.115846, -3.641834],
];
</code></pre>
<p>THREE.jsã«ã¯ã„ãã¤ã‹ã®æ›²ç·šã‚¯ãƒ©ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚
<code class="notranslate" translate="no">CatmullRomCurve3</code> ãŒä½¿ãˆãã†ãªæ°—ãŒã—ãŸã®ã§ <code class="notranslate" translate="no">CatmullRomCurve3</code> ã‚’ä½¿ã£ã¦ã¿ãŸã€‚
ã“ã®æ›²ç·šã¯é ‚ç‚¹ã‚’é€šã‚‹æ»‘ã‚‰ã‹ãªæ›²ç·šã‚’ä½œã‚Šã¾ã™ã€‚</p>
<p>å®Ÿéš›ã«ã¯ã“ã‚Œã‚‰ã®é ‚ç‚¹ã‚’ç›´æ¥å…¥åŠ›ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ãªæ›²ç·šãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚</p>
<div class="threejs_center"><img src="../resources/images/car-curves-before.png" style="width: 400px"></div>

<p>ã—ã‹ã—ã€ã‚‚ã£ã¨è§’ã‚’ã‚·ãƒ£ãƒ¼ãƒ—ã«ã—ã¦æ¬²ã—ã„ã§ã™ã€‚
ã„ãã¤ã‹ã®é ‚ç‚¹ã‚’è¿½åŠ ã—è¨ˆç®—ã™ã‚Œã°ã€æœ›ã‚“ã è§’åº¦ãŒå¾—ã‚‰ã‚Œã‚‹æ°—ãŒã—ã¾ã™ã€‚
å„é ‚ç‚¹ã®ãƒšã‚¢ã§2ã¤ã®ãƒã‚¤ãƒ³ãƒˆã®é–“ã®10%ã¨90%ã®é“ã‚’è¨ˆç®—ã—ã€ãã®çµæœã‚’ <code class="notranslate" translate="no">CatmullRomCurve3</code> ã«æ¸¡ã—ã¾ã™ã€‚</p>
<p>ã“ã®ã‚ˆã†ãªæ›²ç·šãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>
<div class="threejs_center"><img src="../resources/images/car-curves-after.png" style="width: 400px"></div>

<p>æ›²ç·šã‚’ä½œæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">let curve;
let curveObject;
{
  const controlPoints = [
    [1.118281, 5.115846, -3.681386],
    [3.948875, 5.115846, -3.641834],
    [3.960072, 5.115846, -0.240352],
    [3.985447, 5.115846, 4.585005],
    [-3.793631, 5.115846, 4.585006],
    [-3.826839, 5.115846, -14.736200],
    [-14.542292, 5.115846, -14.765865],
    [-14.520929, 5.115846, -3.627002],
    [-5.452815, 5.115846, -3.634418],
    [-5.467251, 5.115846, 4.549161],
    [-13.266233, 5.115846, 4.567083],
    [-13.250067, 5.115846, -13.499271],
    [4.081842, 5.115846, -13.435463],
    [4.125436, 5.115846, -5.334928],
    [-14.521364, 5.115846, -5.239871],
    [-14.510466, 5.115846, 5.486727],
    [5.745666, 5.115846, 5.510492],
    [5.787942, 5.115846, -14.728308],
    [-5.423720, 5.115846, -14.761919],
    [-5.373599, 5.115846, -3.704133],
    [1.004861, 5.115846, -3.641834],
  ];
  const p0 = new THREE.Vector3();
  const p1 = new THREE.Vector3();
  curve = new THREE.CatmullRomCurve3(
    controlPoints.map((p, ndx) =&gt; {
      p0.set(...p);
      p1.set(...controlPoints[(ndx + 1) % controlPoints.length]);
      return [
        (new THREE.Vector3()).copy(p0),
        (new THREE.Vector3()).lerpVectors(p0, p1, 0.1),
        (new THREE.Vector3()).lerpVectors(p0, p1, 0.9),
      ];
    }).flat(),
    true,
  );
  {
    const points = curve.getPoints(250);
    const geometry = new THREE.BufferGeometry().setFromPoints(points);
    const material = new THREE.LineBasicMaterial({color: 0xff0000});
    curveObject = new THREE.Line(geometry, material);
    scene.add(curveObject);
  }
}
</code></pre>
<p>ã“ã®ã‚³ãƒ¼ãƒ‰ã®æœ€åˆã®éƒ¨åˆ†ã¯æ›²ç·šã‚’ä½œã‚Šã¾ã™ã€‚
ã‚³ãƒ¼ãƒ‰ã®2ç•ªç›®ã®éƒ¨åˆ†ã¯æ›²ç·šã‹ã‚‰250é ‚ç‚¹ã‚’ç”Ÿæˆã—ã€ãã®250é ‚ç‚¹ã‚’çµã‚“ã§ä½œã‚‰ã‚ŒãŸç·šã‚’è¡¨ç¤ºã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚</p>
<p><a href="../../threejs-load-gltf-car-path.html">ã“ã®ã‚µãƒ³ãƒ—ãƒ«</a>ã‚’å®Ÿè¡Œã—ã¦ã‚‚ã‚«ãƒ¼ãƒ–ãŒè¦‹ãˆã¾ã›ã‚“ã§ã—ãŸã€‚
è¦‹ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã€æ·±åº¦ãƒ†ã‚¹ãƒˆã‚’ç„¡è¦–ã—ã¦æœ€å¾Œã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">    curveObject = new THREE.Line(geometry, material);
+    material.depthTest = false;
+    curveObject.renderOrder = 1;
</code></pre>
<p>ãã—ã¦ã€ã‚«ãƒ¼ãƒ–ãŒã‚ã¾ã‚Šã«ã‚‚å°ã•ã™ãã‚‹äº‹ã«æ°—ãŒã¤ãã¾ã—ãŸã€‚</p>
<div class="threejs_center"><img src="../resources/images/car-curves-too-small.png" style="width: 498px"></div>

<p>Blenderã§éšå±¤ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã¨ã€3DCGã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆãŒå…¨ã¦ã®è¦ªã¨ãªã‚‹ãƒãƒ¼ãƒ‰ã‚’ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã—ã¦ã„ã¾ã—ãŸã€‚</p>
<div class="threejs_center"><img src="../resources/images/cars-scale-0.01.png" style="width: 342px;"></div>

<p>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®3Dã‚¢ãƒ—ãƒªã§ã¯ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒæ‚ªã§ã™ã€‚
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ 3Dã‚’è¡Œã†éš›ã«ã¯ã€æ§˜ã€…ãªå•é¡ŒãŒç™ºç”Ÿã—ä¸æº€ãŒå°½ãã¾ã›ã‚“ã€‚
3Dã‚¢ãƒ—ãƒªé–‹ç™ºã§ã¯ã‚·ãƒ¼ãƒ³å…¨ä½“ã‚’æ‹¡å¤§ç¸®å°ã™ã‚‹ã®ã¯ã¨ã¦ã‚‚ç°¡å˜ã§ã™ãŒã€3DCGã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã¯ã“ã‚Œã‚’çŸ¥ã‚‰ãªã„äº‹ãŒå¤šã„ã§ã™ã€‚
ã‚‚ã—ã‚ãªãŸãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®3Dã‚¢ãƒ—ãƒªã‚’ä½œã‚ã†ã¨æ±ºã‚ãŸã‚‰ã€3DCGã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã«ã¯çµ¶å¯¾ã«ä½•ã‚‚ã‚¹ã‚±ãƒ¼ãƒ«ã—ãªã„ã‚ˆã†ã«ãŠé¡˜ã„ã™ã‚‹äº‹ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚
ã‚¹ã‚±ãƒ¼ãƒ«ã‚’å¤‰æ›´ã™ã‚‹å ´åˆã¯ã€ãã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚’é ‚ç‚¹ã«é©ç”¨ã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>ã‚¹ã‚±ãƒ¼ãƒ«ã ã‘ã§ãªãã€ãã®è¦ªã§ã‚ã‚‹ <code class="notranslate" translate="no">Cars</code> ãƒãƒ¼ãƒ‰ã«ã‚ˆã£ã¦å›è»¢ã•ã‚Œã‚ªãƒ•ã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚
ã“ã‚Œã§ã¯å®Ÿè¡Œæ™‚ã«ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã§ã®è»Šã®ç§»å‹•ãŒå›°é›£ã«ãªã‚Šã¾ã™ã€‚
ã¯ã£ãã‚Šè¨€ã†ã¨ã€ã“ã®å ´åˆã¯ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã§è»Šã‚’èµ°ã‚‰ã›ãŸã„ã®ã§ã“ã®å•é¡ŒãŒå‡ºã¦ãã¾ã™ã€‚
æœˆãŒåœ°çƒã‚’ä¸­å¿ƒã«å›è»¢ã—ã¦ã„ã‚‹ã‚ˆã†ãªãƒ­ãƒ¼ã‚«ãƒ«åº§æ¨™ã§æ“ä½œã•ã‚Œã‚‹å ´åˆã€ã“ã‚Œã¯ã‚ã¾ã‚Šå•é¡Œã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
<p>ä¸Šè¨˜ã§æ›¸ã„ãŸã‚·ãƒ¼ãƒ³ã‚°ãƒ©ãƒ•ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹é–¢æ•°ã«æˆ»ã‚Šã€å„ãƒãƒ¼ãƒ‰ã®ä½ç½®ã€å›è»¢ã€ã‚¹ã‚±ãƒ¼ãƒ«ã‚’ãƒ€ãƒ³ãƒ—ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">+function dumpVec3(v3, precision = 3) {
+  return `${v3.x.toFixed(precision)}, ${v3.y.toFixed(precision)}, ${v3.z.toFixed(precision)}`;
+}

function dumpObject(obj, lines, isLast = true, prefix = &#39;&#39;) {
  const localPrefix = isLast ? &#39;â””â”€&#39; : &#39;â”œâ”€&#39;;
  lines.push(`${prefix}${prefix ? localPrefix : &#39;&#39;}${obj.name || &#39;*no-name*&#39;} [${obj.type}]`);
+  const dataPrefix = obj.children.length
+     ? (isLast ? &#39;  â”‚ &#39; : &#39;â”‚ â”‚ &#39;)
+     : (isLast ? &#39;    &#39; : &#39;â”‚   &#39;);
+  lines.push(`${prefix}${dataPrefix}  pos: ${dumpVec3(obj.position)}`);
+  lines.push(`${prefix}${dataPrefix}  rot: ${dumpVec3(obj.rotation)}`);
+  lines.push(`${prefix}${dataPrefix}  scl: ${dumpVec3(obj.scale)}`);
  const newPrefix = prefix + (isLast ? &#39;  &#39; : &#39;â”‚ &#39;);
  const lastNdx = obj.children.length - 1;
  obj.children.forEach((child, ndx) =&gt; {
    const isLast = ndx === lastNdx;
    dumpObject(child, lines, isLast, newPrefix);
  });
  return lines;
}
</code></pre>
<p><a href="../../threejs-load-gltf-dump-scenegraph-extra.html">ãã‚Œã‚’å®Ÿè¡Œ</a>ã—ãŸçµæœã§ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-text">OSG_Scene [Scene]
  â”‚   pos: 0.000, 0.000, 0.000
  â”‚   rot: 0.000, 0.000, 0.000
  â”‚   scl: 1.000, 1.000, 1.000
  â””â”€RootNode_(gltf_orientation_matrix) [Object3D]
    â”‚   pos: 0.000, 0.000, 0.000
    â”‚   rot: -1.571, 0.000, 0.000
    â”‚   scl: 1.000, 1.000, 1.000
    â””â”€RootNode_(model_correction_matrix) [Object3D]
      â”‚   pos: 0.000, 0.000, 0.000
      â”‚   rot: 0.000, 0.000, 0.000
      â”‚   scl: 1.000, 1.000, 1.000
      â””â”€4d4100bcb1c640e69699a87140df79d7fbx [Object3D]
        â”‚   pos: 0.000, 0.000, 0.000
        â”‚   rot: 1.571, 0.000, 0.000
        â”‚   scl: 1.000, 1.000, 1.000
        â””â”€RootNode [Object3D]
          â”‚   pos: 0.000, 0.000, 0.000
          â”‚   rot: 0.000, 0.000, 0.000
          â”‚   scl: 1.000, 1.000, 1.000
          â”œâ”€Cars [Object3D]
*          â”‚ â”‚   pos: -369.069, -90.704, -920.159
*          â”‚ â”‚   rot: 0.000, 0.000, 0.000
*          â”‚ â”‚   scl: 1.000, 1.000, 1.000
          â”‚ â”œâ”€CAR_03_1 [Object3D]
          â”‚ â”‚ â”‚   pos: 22.131, 14.663, -475.071
          â”‚ â”‚ â”‚   rot: -3.142, 0.732, 3.142
          â”‚ â”‚ â”‚   scl: 1.500, 1.500, 1.500
          â”‚ â”‚ â””â”€CAR_03_1_World_ap_0 [Mesh]
          â”‚ â”‚       pos: 0.000, 0.000, 0.000
          â”‚ â”‚       rot: 0.000, 0.000, 0.000
          â”‚ â”‚       scl: 1.000, 1.000, 1.000
</code></pre>
<p>ã“ã‚Œã¯å…ƒã®ã‚·ãƒ¼ãƒ³ã® <code class="notranslate" translate="no">Cars</code> ã®å›è»¢ã¨ã‚¹ã‚±ãƒ¼ãƒ«ãŒå‰Šé™¤ã•ã‚Œã€å­ã«é©ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã®åŸå› ã¯ã€GLTFãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚ŒãŸã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãŒä½•ã‹ç‰¹åˆ¥ãªä½œæ¥­ã‚’ã—ãŸã‹ã€ã¾ãŸã¯3DCGã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆãŒå¯¾å¿œã™ã‚‹blendãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯ç•°ãªã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸå¯èƒ½æ€§ãŒé«˜ã„ã§ã™ã€‚</p>
<p>ã“ã®äº‹ã‹ã‚‰å­¦ã¶æ•™è¨“ã¯ã€blendãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦è‡ªåˆ†ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã¹ãã¨ã„ã†äº‹ã§ã™ã€‚
ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹å‰ã«ä¸»è¦ãªãƒãƒ¼ãƒ‰ã‚’å…¨ã¦æ¤œæŸ»ã—ã€å¤‰æ›ã‚’å‰Šé™¤ã—ã¦ãŠãã¹ãã§ã—ãŸã€‚</p>
<p>Topã«ã‚ã‚‹ã“ã‚Œã‚‰å…¨ã¦ã®ãƒãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-text">OSG_Scene [Scene]
  â”‚   pos: 0.000, 0.000, 0.000
  â”‚   rot: 0.000, 0.000, 0.000
  â”‚   scl: 1.000, 1.000, 1.000
  â””â”€RootNode_(gltf_orientation_matrix) [Object3D]
    â”‚   pos: 0.000, 0.000, 0.000
    â”‚   rot: -1.571, 0.000, 0.000
    â”‚   scl: 1.000, 1.000, 1.000
    â””â”€RootNode_(model_correction_matrix) [Object3D]
      â”‚   pos: 0.000, 0.000, 0.000
      â”‚   rot: 0.000, 0.000, 0.000
      â”‚   scl: 1.000, 1.000, 1.000
      â””â”€4d4100bcb1c640e69699a87140df79d7fbx [Object3D]
        â”‚   pos: 0.000, 0.000, 0.000
        â”‚   rot: 1.571, 0.000, 0.000
        â”‚   scl: 1.000, 1.000, 1.000
</code></pre>
<p>ã“ã®éšå±¤æ§‹é€ ã¯ã‚‚ã£ãŸã„ãªã„ã§ã™ã­ã€‚</p>
<p>ç†æƒ³çš„ã«ã¯ã‚·ãƒ¼ãƒ³ã¯ä½ç½®ã€å›è»¢ã€ã‚¹ã‚±ãƒ¼ãƒ«ã®ãªã„å˜ä¸€ã®&quot;ãƒ«ãƒ¼ãƒˆ&quot;ãƒãƒ¼ãƒ‰ã§æ§‹æˆã•ã‚Œã‚‹äº‹ã§ã™ã€‚
å®Ÿè¡Œæ™‚ã«ã¯ãã®ãƒ«ãƒ¼ãƒˆã‹ã‚‰å…¨ã¦ã®å­ã‚’å–ã‚Šå‡ºã—ã€ã‚·ãƒ¼ãƒ³è‡ªä½“ã‚’è¦ªã«ã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚
&quot;Cars&quot;ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒˆã®å­ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€å…¨ã¦ã®è»Šã‚’è¦‹ã¤ã‘ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚ç†æƒ³çš„ã«ã¯å¹³è¡Œç§»å‹•ã€å›è»¢ã€ã‚¹ã‚±ãƒ¼ãƒ«ãŒãªã„ã®ã§ã€æœ€å°é™ã®ä½œæ¥­ã§ã‚·ãƒ¼ãƒ³ã‚’è»Šã®è¦ªã«ã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚</p>
<p>ã„ãšã‚Œã«ã—ã¦ã‚‚ã€ã‚«ãƒ¼ãƒ–ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¦ã„ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’èª¿æ•´ã™ã‚‹ã®ãŒä¸€ç•ªæ‰‹ã£å–ã‚Šæ—©ã„ã®ã§ã™ãŒã€æœ€å–„ã®æ–¹æ³•ã§ã¯ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>
<p>çµå±€ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ã­ã€‚</p>
<p>æœ€åˆã«ã‚«ãƒ¼ãƒ–ã®ä½ç½®ã‚’èª¿æ•´ã—ã€ä¸Šæ‰‹ãã„ããã†ãªå€¤ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚ãã—ã¦éš ã—ã¾ã—ãŸã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">{
  const points = curve.getPoints(250);
  const geometry = new THREE.BufferGeometry().setFromPoints(points);
  const material = new THREE.LineBasicMaterial({color: 0xff0000});
  curveObject = new THREE.Line(geometry, material);
+  curveObject.scale.set(100, 100, 100);
+  curveObject.position.y = -621;
+  curveObject.visible = false;
  material.depthTest = false;
  curveObject.renderOrder = 1;
  scene.add(curveObject);
}
</code></pre>
<p>ãã‚Œã‹ã‚‰ã‚«ãƒ¼ãƒ–ã«æ²¿ã£ã¦ç§»å‹•ã•ã›ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã—ãŸã€‚
ãã‚Œãã‚Œã®è»Šã§æ›²ç·šã«æ²¿ã£ã¦0ã‹ã‚‰1ã¾ã§ã®ä½ç½®ã‚’é¸ã³ <code class="notranslate" translate="no">curveObject</code> ã‚’ç”¨ã„ã¦ãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ä¸Šã®é ‚ç‚¹ã‚’è¨ˆç®—ã—ã¦å¤‰æ›ã—ã¾ã™ã€‚
æ¬¡ã«ã‚«ãƒ¼ãƒ–ã®å°‘ã—ä¸‹ã®æ–¹ã«ã‚ã‚‹åˆ¥ã®é ‚ç‚¹ã‚’é¸ã³ã¾ã™ã€‚
è»Šã®å‘ãã‚’ <code class="notranslate" translate="no">lookAt</code> ã§è¨­å®šã—ã€2ç‚¹é–“ã®ä¸­é–“ç‚¹ã«è»Šã‚’é…ç½®ã—ã¾ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">// create 2 Vector3s we can use for path calculations
const carPosition = new THREE.Vector3();
const carTarget = new THREE.Vector3();

function render(time) {
  ...

-  for (const car of cars) {
-    car.rotation.y = time;
-  }

+  {
+    const pathTime = time * .01;
+    const targetOffset = 0.01;
+    cars.forEach((car, ndx) =&gt; {
+      // a number between 0 and 1 to evenly space the cars
+      const u = pathTime + ndx / cars.length;
+
+      // get the first point
+      curve.getPointAt(u % 1, carPosition);
+      carPosition.applyMatrix4(curveObject.matrixWorld);
+
+      // get a second point slightly further down the curve
+      curve.getPointAt((u + targetOffset) % 1, carTarget);
+      carTarget.applyMatrix4(curveObject.matrixWorld);
+
+      // put the car at the first point (temporarily)
+      car.position.copy(carPosition);
+      // point the car the second point
+      car.lookAt(carTarget);
+
+      // put the car between the 2 points
+      car.position.lerpVectors(carPosition, carTarget, 0.5);
+    });
+  }
</code></pre>
<p>ãã—ã¦ãã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãã‚Œãã‚Œã®è»Šã®ã‚ªãƒªã‚¸ãƒ³ã®ä¸Šã«é«˜ã•ãŒä¸€è²«ã—ã¦è¨­å®šã•ã‚Œã¦ã„ãªã‹ã£ãŸã®ã§ã€å°‘ã—ã‚ªãƒ•ã‚»ãƒƒãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const loadedCars = root.getObjectByName(&#39;Cars&#39;);
const fixes = [
-  { prefix: &#39;Car_08&#39;, rot: [Math.PI * .5, 0, Math.PI * .5], },
-  { prefix: &#39;CAR_03&#39;, rot: [0, Math.PI, 0], },
-  { prefix: &#39;Car_04&#39;, rot: [0, Math.PI, 0], },
+  { prefix: &#39;Car_08&#39;, y: 0,  rot: [Math.PI * .5, 0, Math.PI * .5], },
+  { prefix: &#39;CAR_03&#39;, y: 33, rot: [0, Math.PI, 0], },
+  { prefix: &#39;Car_04&#39;, y: 40, rot: [0, Math.PI, 0], },
];

root.updateMatrixWorld();
for (const car of loadedCars.children.slice()) {
  const fix = fixes.find(fix =&gt; car.name.startsWith(fix.prefix));
  const obj = new THREE.Object3D();
  car.getWorldPosition(obj.position);
-  car.position.set(0, 0, 0);
+  car.position.set(0, fix.y, 0);
  car.rotation.set(...fix.rot);
  obj.add(car);
  scene.add(obj);
  cars.push(obj);
}
</code></pre>
<p>ãã®çµæœã§ã™ã€‚</p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf-animated-cars.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf-animated-cars.html" target="_blank">ã“ã“ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦åˆ¥ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ãã¾ã™</a>
</div>

</p>
<p>æ•°åˆ†é–“ã®ä½œæ¥­ã«ã—ã¦ã¯æ‚ªããªã„çµæœã§ã™ã€‚</p>
<p>æœ€å¾Œã«ã‚„ã‚ŠãŸã„ã®ã¯ã‚·ãƒ£ãƒ‰ã‚¦ã‚’ã¤ã‘ã‚‹äº‹ã§ã™ã€‚</p>
<p>ã“ã‚Œã‚’è¡Œã†ãŸã‚ã«<a href="threejs-shadows.html">ã‚·ãƒ£ãƒ‰ã‚¦ã®è¨˜äº‹</a>ã«ã‚ã‚‹ <code class="notranslate" translate="no">DirectionalLight</code> ã®ä¾‹ã‹ã‚‰å…¨ã¦ã®GUIã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã€æœ€æ–°ã®ã‚³ãƒ¼ãƒ‰ã«è²¼ã‚Šä»˜ã‘ã¾ã—ãŸã€‚</p>
<p>èª­ã¿è¾¼ã¿å¾Œã«å…¨ã¦ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚·ãƒ£ãƒ‰ã‚¦ã‚’ã‚ªãƒ³ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">{
  const gltfLoader = new GLTFLoader();
  gltfLoader.load(&#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;, (gltf) =&gt; {
    const root = gltf.scene;
    scene.add(root);

+    root.traverse((obj) =&gt; {
+      if (obj.castShadow !== undefined) {
+        obj.castShadow = true;
+        obj.receiveShadow = true;
+      }
+    });
</code></pre>
<p>ã‚·ãƒ£ãƒ‰ã‚¦ãƒ˜ãƒ«ãƒ‘ãƒ¼ãŒæ©Ÿèƒ½ã—ã¦ã„ãªã„ç†ç”±ã‚’æ¢ã‚‹ã®ã«4æ™‚é–“è¿‘ãã‚’è²»ã‚„ã—ã¾ã—ãŸã€‚
ã‚·ãƒ£ãƒ‰ã‚¦ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã®ã‚’å¿˜ã‚Œã¦ã„ãŸã®ãŒåŸå› ã§ã—ãŸã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">renderer.shadowMap.enabled = true;
</code></pre>
<p>ğŸ˜­</p>
<p>ãã®ã‚ã¨ã€<code class="notranslate" translate="no">DirectionLight</code> ã®ã‚·ãƒ£ãƒ‰ã‚¦ã‚«ãƒ¡ãƒ©ãŒã‚·ãƒ¼ãƒ³å…¨ä½“ã‚’è¦†ã†ã‚ˆã†ã«ãªã‚‹ã¾ã§å€¤ã‚’èª¿æ•´ã—ã¾ã—ãŸã€‚
ã“ã‚Œã‚‰ã®è¨­å®šã¯ç§ãŒæœ€çµ‚çš„ã«ãŸã©ã‚Šç€ã„ãŸã‚‚ã®ã§ã™ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">{
  const color = 0xFFFFFF;
  const intensity = 1;
  const light = new THREE.DirectionalLight(color, intensity);
+  light.castShadow = true;
*  light.position.set(-250, 800, -850);
*  light.target.position.set(-550, 40, -450);

+  light.shadow.bias = -0.004;
+  light.shadow.mapSize.width = 2048;
+  light.shadow.mapSize.height = 2048;

  scene.add(light);
  scene.add(light.target);
+  const cam = light.shadow.camera;
+  cam.near = 1;
+  cam.far = 2000;
+  cam.left = -1500;
+  cam.right = 1500;
+  cam.top = 1500;
+  cam.bottom = -1500;
...
</code></pre>
<p>ã¾ãŸã€èƒŒæ™¯è‰²ã‚’æ°´è‰²ã«è¨­å®šã—ã¦ã¿ã¾ã—ãŸã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">const scene = new THREE.Scene();
-scene.background = new THREE.Color(&#39;black&#39;);
+scene.background = new THREE.Color(&#39;#DEFEFF&#39;);
</code></pre>
<p>ãã—ã¦ã€ã‚·ãƒ£ãƒ‰ã‚¦ã‚’ã¤ã‘ãŸçµæœã§ã™ã€‚</p>
<p><div translate="no" class="threejs_example_container notranslate">
  <div><iframe class="threejs_example notranslate" translate="no" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-load-gltf-shadows.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-load-gltf-shadows.html" target="_blank">ã“ã“ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦åˆ¥ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ãã¾ã™</a>
</div>

</p>
<p>ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èª¬æ˜ã™ã‚‹äº‹ã§ã€ã‚·ãƒ¼ãƒ³ã‚°ãƒ©ãƒ•ã‚’ä½¿ã£ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­è¾¼ã™ã‚‹éš›ã®å•é¡Œç‚¹ãƒ»è§£æ±ºäº‹ä¾‹ã‚’ã„ãã¤ã‹ç¤ºã›ãŸã¨æ€ã„ã¾ã™ã€‚</p>
<p>èˆˆå‘³æ·±ã„ã®ã¯blendãƒ•ã‚¡ã‚¤ãƒ«ã¨gltfãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆã€blendãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã„ãã¤ã‹ã®ãƒ©ã‚¤ãƒˆãŒã‚ã‚Šã¾ã™ãŒã€ã‚·ãƒ¼ãƒ³ã«èª­ã¿è¾¼ã¿å¾Œã¯ãƒ©ã‚¤ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚
GLTFãƒ•ã‚¡ã‚¤ãƒ«ã¯ãŸã ã®JSONãƒ•ã‚¡ã‚¤ãƒ«ãªã®ã§ç°¡å˜ã«ä¸­èº«ã‚’è¦‹ã‚Œã¾ã™ã€‚
ã“ã‚Œã¯è¤‡æ•°ã®é…åˆ—ã‹ã‚‰æˆã‚Šã€é…åˆ—å†…ã®å„é …ç›®ã¯ä»–ã®å ´æ‰€ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä»˜ã‘ã¦å‚ç…§ã•ã‚Œã¾ã™ã€‚
æ‹¡å¼µæ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ãŒã€ã»ã¨ã‚“ã©å…¨ã¦ã®3Dãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®å•é¡Œã‚’æŒ‡æ‘˜ã—ã¦ã„ã¾ã™ã€‚<strong>å…¨ã¦ã®ã‚±ãƒ¼ã‚¹ã‚’ã‚«ãƒãƒ¼ã™ã‚‹äº‹ã¯ã§ãã¾ã›ã‚“ã€‚</strong></p>
<p>ã‚‚ã£ã¨ãƒ‡ãƒ¼ã‚¿ãŒæ¬²ã—ã„ã¨ã„ã†ãƒ‹ãƒ¼ã‚ºã¯å¸¸ã«ã‚ã‚Šã¾ã™ã€‚
ä¾‹ãˆã°ä»Šå›ã¯æ‰‹å‹•ã§è»Šã®ãƒ‘ã‚¹ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸã€‚
ç†æƒ³çš„ã«ã¯GLTFãƒ•ã‚¡ã‚¤ãƒ«ã«æƒ…å ±ã‚’æ ¼ç´ã™ã‚‹äº‹ãŒã§ãã¾ã™ãŒã€ç‹¬è‡ªã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ã‚’ä½œæˆã—ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸã„æ–¹æ³•ã§ãƒãƒ¼ãƒ‰ã‚’ãƒãƒ¼ã‚¯ã™ã‚‹ã‹ã€å‘½åã‚¹ã‚­ãƒ¼ãƒ ãªã©ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ„ãƒ¼ãƒ«ã‹ã‚‰ã‚¢ãƒ—ãƒªã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>ãã®å…¨ã¦ã¯èª­è€…ã®çš†æ§˜ã®æ¼”ç¿’ã¨ã—ã¦ãŠä»»ã›ã—ã¾ã™ã€‚</p>

    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/threejs/lessons/threejs-load-gltf.html" >English</a>
    <option value="/threejs/lessons/fr/threejs-load-gltf.html" >FranÃ§ais</a>
    <option value="/threejs/lessons/ja/threejs-load-gltf.html" selected>æ—¥æœ¬èª</a>
    <option value="/threejs/lessons/kr/threejs-load-gltf.html" >í•œêµ­ì–´</a>
    <option value="/threejs/lessons/ru/threejs-load-gltf.html" >Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
    <option value="/threejs/lessons/zh_cn/threejs-load-gltf.html" >ä¸­æ–‡</a>
</select>


        <div id="toc">
          <ul>  <li>åŸºæœ¬</li>
        <ul>
          <li><a href="/threejs/lessons/ja/threejs-fundamentals.html">åŸºç¤çŸ¥è­˜</a></li>
<li><a href="/threejs/lessons/ja/threejs-responsive.html">ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³</a></li>
<li><a href="/threejs/lessons/ja/threejs-prerequisites.html">å‰ææ¡ä»¶</a></li>
<li><a href="/threejs/lessons/ja/threejs-setup.html">ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</a></li>
        </ul>
  <li>åŸºç¤</li>
        <ul>
          <li><a href="/threejs/lessons/ja/threejs-primitives.html">ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–</a></li>
<li><a href="/threejs/lessons/ja/threejs-scenegraph.html">ã‚·ãƒ¼ãƒ³ã‚°ãƒ©ãƒ•</a></li>
<li><a href="/threejs/lessons/ja/threejs-materials.html">ãƒãƒ†ãƒªã‚¢ãƒ«</a></li>
<li><a href="/threejs/lessons/ja/threejs-textures.html">ãƒ†ã‚¯ã‚¹ãƒãƒ£</a></li>
<li><a href="/threejs/lessons/ja/threejs-lights.html">Lights</a></li>
<li><a href="/threejs/lessons/ja/threejs-cameras.html">Cameras</a></li>
<li><a href="/threejs/lessons/ja/threejs-shadows.html">Shadows</a></li>
<li><a href="/threejs/lessons/ja/threejs-fog.html">Fog</a></li>
<li><a href="/threejs/lessons/ja/threejs-rendertargets.html">Render Targets</a></li>
<li><a href="/threejs/lessons/ja/threejs-custom-geometry.html">Custom Geometry</a></li>
<li><a href="/threejs/lessons/ja/threejs-custom-buffergeometry.html">Custom BufferGeometry</a></li>
        </ul>
  <li>Tips</li>
        <ul>
          <li><a href="/threejs/lessons/ja/threejs-rendering-on-demand.html">è¦æ±‚ã•ã‚ŒãŸãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°</a></li>
<li><a href="/threejs/lessons/ja/threejs-debugging-javascript.html">JavaScriptã®ãƒ‡ãƒãƒƒã‚°</a></li>
<li><a href="/threejs/lessons/ja/threejs-debugging-glsl.html">GLSLã®ãƒ‡ãƒãƒƒã‚°</a></li>
<li><a href="/threejs/lessons/ja/threejs-tips.html#screenshot">ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®ã‚‹</a></li>
<li><a href="/threejs/lessons/ja/threejs-tips.html#preservedrawingbuffer">ã‚­ãƒ£ãƒ³ãƒã‚¹ãŒã‚¯ãƒªã‚¢ã•ã‚Œã‚‹ã®ã‚’é˜²ã</a></li>
<li><a href="/threejs/lessons/ja/threejs-tips.html#tabindex">ã‚­ãƒ£ãƒ³ãƒã‚¹ã‹ã‚‰ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’å–å¾—ã™ã‚‹</a></li>
<li><a href="/threejs/lessons/ja/threejs-tips.html#transparent-canvas">ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’é€æ˜ã«ã™ã‚‹</a></li>
<li><a href="/threejs/lessons/ja/threejs-tips.html#html-background">HTMLã®èƒŒæ™¯ã«three.jsã‚’ä½¿ã†</a></li>
        </ul>
  <li>æœ€é©åŒ–</li>
        <ul>
          <li><a href="/threejs/lessons/ja/threejs-optimize-lots-of-objects.html">å¤šãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æœ€é©åŒ–</a></li>
<li><a href="/threejs/lessons/ja/threejs-optimize-lots-of-objects-animated.html">ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹å¤šãã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æœ€é©åŒ–</a></li>
<li><a href="/threejs/lessons/ja/threejs-offscreencanvas.html">Web Workerã§OffscreenCanvasã‚’ä½¿ç”¨ã™ã‚‹</a></li>
        </ul>
  <li>è§£æ±ºç­–</li>
        <ul>
          <li><a href="/threejs/lessons/ja/threejs-load-obj.html">OBJãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿</a></li>
<li><a href="/threejs/lessons/ja/threejs-load-gltf.html">GLTFãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿</a></li>
<li><a href="/threejs/lessons/ja/threejs-backgrounds.html">èƒŒæ™¯ã‚„ã‚¹ã‚«ã‚¤ãƒœãƒƒã‚¯ã‚¹ã‚’è¿½åŠ ã™ã‚‹</a></li>
<li><a href="/threejs/lessons/ja/threejs-transparency.html">How to Draw Transparent Objects</a></li>
<li><a href="/threejs/lessons/ja/threejs-multiple-scenes.html">Multiple Canvases, Multiple Scenes</a></li>
<li><a href="/threejs/lessons/ja/threejs-picking.html">Picking Objects with the mouse</a></li>
<li><a href="/threejs/lessons/ja/threejs-post-processing.html">Post Processing</a></li>
<li><a href="/threejs/lessons/ja/threejs-post-processing-3dlut.html">Applying a LUT File for effects</a></li>
<li><a href="/threejs/lessons/ja/threejs-shadertoy.html">Using Shadertoy shaders</a></li>
<li><a href="/threejs/lessons/ja/threejs-align-html-elements-to-3d.html">Aligning HTML Elements to 3D</a></li>
<li><a href="/threejs/lessons/ja/threejs-indexed-textures.html">Using Indexed Textures for Picking and Color</a></li>
<li><a href="/threejs/lessons/ja/threejs-canvas-textures.html">Using A Canvas for Dynamic Textures</a></li>
<li><a href="/threejs/lessons/ja/threejs-billboards.html">Billboards and Facades</a></li>
<li><a href="/threejs/lessons/ja/threejs-cleanup.html">Freeing Resources</a></li>
<li><a href="/threejs/lessons/ja/threejs-voxel-geometry.html">Making Voxel Geometry (Minecraft)</a></li>
<li><a href="/threejs/lessons/ja/threejs-game.html">Start making a Game.</a></li>
        </ul>
  <li>WebVR</li>
        <ul>
          <li><a href="/threejs/lessons/ja/threejs-webvr.html">VR - Basics</a></li>
<li><a href="/threejs/lessons/ja/threejs-webvr-look-to-select.html">VR - Look To Select</a></li>
<li><a href="/threejs/lessons/ja/threejs-webvr-point-to-select.html">VR - Point To Select</a></li>
        </ul>
  <li>å‚ç…§</li>
        <ul>
          <li><a href="/threejs/lessons/ja/threejs-material-table.html">Material Table</a></li>
        </ul></ul>
<ul>
  <li><a href="https://github.com/gfxfundamentals/threejsfundamentals">github</a></li>
  <li><a href="https://threejs.org">three.js</a></li>
  <li><a href="https://threejs.org/docs/">three.jsãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a></li>
</ul>

        </div>
    </div>
    <div class="lesson-comments">
        <div>è³ªå•ã¯ã‚ã‚Šã¾ã™ã‹? <a href="http://stackoverflow.com/questions/tagged/three.js">ä½•ã‹ã‚ã‚Œã°stackoverflowã§å°‹ã­ã¦ä¸‹ã•ã„</a>.</div>
        <div>Issue/Bug? <a href="http://github.com/greggman/threefundamentals/issues">ã¾ãŸã¯githubã§issueã‚’ä½œã£ã¦ä¸‹ã•ã„</a>.</div>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'threejsfundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'Three.jsã§GLFTãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€';
            var disqus_title = 'Three.jsã§GLFTãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("threejsfundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script src="/3rdparty/jquery-3.3.1.slim.min.js"></script>
<script src="/threejs/lessons/resources/prettify.js"></script>
<script src="/threejs/lessons/resources/lesson.js"></script>
<script>
(function() {
  if (window.location.hostname.indexOf("threejsfundamentals.org") < 0) {
      return;
  }

  function addScript(src, fn) {
    const script = document.createElement('script');
    const firstScript = document.getElementsByTagName('script')[0];
    script.async = true;
    script.defer = true;
    if (fn) {
      script.addEventListener('load', fn);
    }
    script.src = src;
    firstScript.parentNode.insertBefore(script, firstScript);
  }

  addScript('//cdn.webglstats.com/stat.js');
  addScript('https://www.googletagmanager.com/gtag/js?id=UA-120733518-1', () => {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-120733518-1');
  });
}());
</script>


</html>



