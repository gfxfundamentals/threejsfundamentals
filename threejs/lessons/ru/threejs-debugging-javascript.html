<!DOCTYPE html>
<!-- this file is auto-generated from threejs/lessons/ru/threejs-debugging-javascript.md. Do not edited directly -->
<!--
Copyright 2018, Google Inc.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of Google Inc. nor the names of their
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Отладка JavaScript с THREE.js" />
<meta name="keywords" content="webgl graphics three.js" />
<meta name="thumbnail" content="https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-debugging-javascript_ru.jpg" />

<meta property="og:title" content="Three.js Отладка JavaScript" />
<meta property="og:type" content="website" />
<meta property="og:image" content="https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-debugging-javascript_ru.jpg" />
<meta property="og:description" content="Отладка JavaScript с THREE.js" />
<meta property="og:url" content="https://threejsfundamentals.org/threejs/lessons/ru/threejs-debugging-javascript.html" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@greggman" />
<meta name="twitter:creator" content="@greggman" />
<meta name="twitter:domain" content="threejsfundamentals.org" />
<meta name="twitter:title" content="Three.js Отладка JavaScript" />
<meta name="twitter:url" content="https://threejsfundamentals.org/threejs/lessons/ru/threejs-debugging-javascript.html" />
<meta name="twitter:description" content="Отладка JavaScript с THREE.js" />
<meta name="twitter:image:src" content="https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-debugging-javascript_ru.jpg" />

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://threejsfundamentals.org/#website",
      "url":"https://threejsfundamentals.org/",
      "name":"ThreejsFundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://threejsfundamentals.org/threejs/lessons/ru/threejs-debugging-javascript.html#primaryimage",
      "url":"https://threejsfundamentals.org/threejs/lessons/screenshots/threejs-debugging-javascript_ru.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://threejsfundamentals.org/threejs/lessons/ru/threejs-debugging-javascript.html#webpage",
      "url":"https://threejsfundamentals.org/threejs/lessons/ru/threejs-debugging-javascript.html",
      "inLanguage":"ru",
      "name":"Three.js Отладка JavaScript",
      "keywords":"webgl graphics three.js programming",
      "isPartOf":{
        "@id":"https://threejsfundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://threejsfundamentals.org/threejs/lessons/ru/threejs-debugging-javascript.html#primaryimage"
      }
    }
  ]
}
</script>

<title>Three.js Отладка JavaScript</title>
<link href="/threejs/lessons/resources/threejsfundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="apple-touch-icon" href="/threejs/lessons/resources/threejsfundamentals-icon.png">
<link rel="icon" href="/threejs/lessons/resources/threejsfundamentals-icon.png">

<link rel="stylesheet" href="/threejs/lessons/lang.css" />
<link rel="stylesheet" href="/threejs/lessons/resources/lesson.css" />
</head>
<body>
<div class="threejs_navbar">
  <div>
    <select class="language">
    <option value="/threejs/lessons/threejs-debugging-javascript.html" >English</a>
    <option value="/threejs/lessons/fr/threejs-debugging-javascript.html" >Français</a>
    <option value="/threejs/lessons/kr/threejs-debugging-javascript.html" >한국어</a>
    <option value="/threejs/lessons/ru/threejs-debugging-javascript.html" selected>Русский</a>
    <option value="/threejs/lessons/zh_cn/threejs-debugging-javascript.html" >中文</a>
</select>


    <a href="#toc">Оглавление</a>
  </div>
</div>
<div class="threejs_header">
  <h1><a href="/threejs/lessons/ru/">threejsfundamentals.org</a></h1>
<style>
#forkongithub a {
    background: #000;
    color: #fff;
    text-decoration: none;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 2rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 300px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(150px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a:hover {
    background: #c11;
    color: #fff;
}
#forkongithub a::before,#forkongithub a::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub a::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
@media (max-width: 900px) {
    #forkongithub a{
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub a{
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><a href="https://github.com/gfxfundamentals/threejsfundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>Three.js Отладка JavaScript</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>Большая часть этой статьи посвящена не непосредственно 
THREE.js, а скорее об отладке JavaScript в целом. 
Мне показалось важным, что многие люди, начинающие с THREE.js,
также начинают с JavaScript, поэтому я надеюсь, что это поможет
им легче решать любые возникающие проблемы. </p>
<p>Отладка - большая тема, и я, вероятно, не смогу охватить все, что нужно знать, но если вы новичок в JavaScript,
вот несколько советов. Я настоятельно рекомендую вам потратить некоторое время на их изучение. Они очень помогут вам в вашем обучении. </p>
<h2 id="-">Изучите инструменты разработчика вашего браузера</h2>
<p>Все браузеры имеют инструменты разработчика. 
<a href="https://developers.google.com/web/tools/chrome-devtools/">Chrome</a>,
<a href="https://developer.mozilla.org/en-US/docs/Tools">Firefox</a>, 
<a href="https://developer.apple.com/safari/tools/">Safari</a>, 
<a href="https://docs.microsoft.com/en-us/microsoft-edge/devtools-guide">Edge</a>.</p>
<p>В Chrome вы можете кликнуть значок <code>⋮</code> , выбрать More Tools-&gt;Developer Tools
чтобы перейти к инструментам разработчика. Сочетание клавиш также показано там. </p>
<div class="threejs_center"><img class="border" src="../resources/images/devtools-chrome.jpg" style="width: 789px;"></div>

<p>В Firefox вы кликаете значок <code>☰</code> , выбираете &quot;Web Developer&quot;, затем выбираете
&quot;Toggle Tools&quot;</p>
<div class="threejs_center"><img class="border" src="../resources/images/devtools-firefox.jpg" style="width: 786px;"></div>

<p>В Safari сначала необходимо включить меню «Разработка» в разделе 
«Дополнительные настройки Safari».</p>
<div class="threejs_center"><img class="border" src="../resources/images/devtools-enable-safari.jpg" style="width: 775px;"></div>

<p>Затем в меню «Разработка» вы можете выбрать «Показать / подключить веб-инспектора». </p>
<div class="threejs_center"><img class="border" src="../resources/images/devtools-safari.jpg" style="width: 777px;"></div>

<p>С Chrome вы также можете 
<a href="https://developers.google.com/web/tools/chrome-devtools/remote-debugging/">использовать Chrome на своем компьютере для отладки веб-страниц, работающих на Chrome, на вашем телефоне или планшете Android</a>.
Точно так же с Safari вы можете
<a href="https://www.google.com/search?q=safari+remote+debugging+ios">использовать свой компьютер для отладки веб-страниц, работающих в Safari на iPhone и iPad</a>.</p>
<p>Я наиболее знаком с Chrome, поэтому в этом руководстве будет использоваться Chrome в качестве примера при обращении к инструментам,
но большинство браузеров имеют схожие функции, поэтому здесь должно быть легко применить что-либо для всех браузеров. </p>
<h2 id="-">Выключить кеш</h2>
<p>Браузеры пытаются повторно использовать уже загруженные данные. Это очень удобно для пользователей, 
поэтому, если вы заходите на веб-сайт во второй раз, многие файлы, используемые для отображения сайта, больше не будут загружаться. </p>
<p>С другой стороны, это может быть плохо для веб-разработки. 
Вы изменяете файл на своем компьютере, перезагружаете страницу
и не видите изменений, потому что браузер использует версию, полученную в прошлый раз. </p>
<p>Сначала выберите настройки из углового меню </p>
<div class="threejs_center"><img class="border" src="../resources/images/devtools-chrome-settings.jpg" style="width: 778px"></div>

<p>Затем выберите &quot;Отключить кэш (пока открыт DevTools)&quot;.</p>
<div class="threejs_center"><img class="border" src="../resources/images/devtools-chrome-disable-cache.jpg" style="width: 779px"></div>

<h2 id="-javascript">Используйте консоль JavaScript</h2>
<p>Внутри всех devtools есть <em>консоль</em>. Показывает предупреждения и сообщения об ошибках. </p>
<p><strong> ЧИТАЙТЕ СООБЩЕНИЯ!! </strong></p>
<p>Обычно должно быть только 1 или 2 сообщения. </p>
<div class="threejs_center"><img class="border" src="../resources/images/devtools-no-errors.jpg" style="width: 779px"></div>

<p>Если вы видите какие-либо другие <strong>ПРОЧИТАЙТЕ ИХ</strong>. Например:</p>
<div class="threejs_center"><img class="border" src="../resources/images/devtools-errors.jpg" style="width: 779px"></div>

<p>Я неправильно написал «three» как «threee» </p>
<p>Вы также можете распечатать свою собственную информацию на консоли с помощью <code>console.log</code>, как в</p>
<pre class="prettyprint"><code class="lang-js">console.log(someObject.position.x, someObject.position.y, someObject.position.z);
</code></pre>
<p>Даже круче, если вы регистрируете объект, вы можете инспектировать его. Например, если мы регистрируем объект корневой сцены из <a href="threejs-load-gltf.html">статьи gLTF</a></p>
<pre class="prettyprint"><code class="lang-js">  {
    const gltfLoader = new GLTFLoader();
    gltfLoader.load(&#39;resources/models/cartoon_lowpoly_small_city_free_pack/scene.gltf&#39;, (gltf) =&gt; {
      const root = gltf.scene;
      scene.add(root);
+      console.log(root);
</code></pre>
<p>Затем мы можем развернуть этот объект в консоли JavaScript </p>
<div class="threejs_center"><img class="border" src="../resources/images/devtools-console-object.gif"></div>

<p>Вы также можете использовать <code>console.error</code>, который сообщает, что сообщение красным цветом включает в себя трассировку стека.</p>
<h2 id="-">Поместить данные на экран</h2>
<p>Другой очевидный, но часто упускаемый из виду способ - добавить теги <code>&lt;div&gt;</code> или <code>&lt;pre&gt;</code> и поместить в них данные. </p>
<p>Самый очевидный способ - сделать некоторые элементы HTML </p>
<pre class="prettyprint"><code class="lang-html">&lt;canvas id=&quot;c&quot;&gt;&lt;/canvas&gt;
+&lt;div id=&quot;debug&quot;&gt;
+  &lt;div&gt;x:&lt;span id=&quot;x&quot;&gt;&lt;/span&gt;&lt;/div&gt;
+  &lt;div&gt;y:&lt;span id=&quot;y&quot;&gt;&lt;/span&gt;&lt;/div&gt;
+  &lt;div&gt;z:&lt;span id=&quot;z&quot;&gt;&lt;/span&gt;&lt;/div&gt;
+&lt;/div&gt;
</code></pre>
<p>Разместите стиле вверху холста. (при условии, что ваш холст заполняет страницу)</p>
<pre class="prettyprint"><code class="lang-html">&lt;style&gt;
#debug {
  position: absolute;
  left: 1em;
  top: 1em;
  padding: 1em;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  font-family: monospace;
}
&lt;/style&gt;
</code></pre>
<p>А затем найдите элементы и настройте их содержимое.</p>
<pre class="prettyprint"><code class="lang-js">// at init time
const xElem = document.querySelector(&#39;#x&#39;);
const yElem = document.querySelector(&#39;#y&#39;);
const zElem = document.querySelector(&#39;#z&#39;);

// at render or update time
xElem.textContent = someObject.position.x.toFixed(3);
yElem.textContent = someObject.position.y.toFixed(3);
zElem.textContent = someObject.position.z.toFixed(3);
</code></pre>
<p>Это более полезно для значений в реальном времени</p>
<p><div class="threejs_example_container">
  <div><iframe class="threejs_example" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-debug-js-html-elements.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-debug-js-html-elements.html" target="_blank">нажмите здесь, чтобы открыть в отдельном окне</a>
</div>

</p>
<p>Еще один способ вывести данные на экран - это очистить регистратор.
Я только что придумал этот термин, но многие игры, над которыми я работал,
использовали это решение. Идея в том, что у вас есть буфер, который 
отображает сообщения только для одного кадра. Любая часть вашего кода, которая хочет отображать данные, 
вызывает некоторую функцию для добавления данных в этот буфер каждый кадр. 
Это гораздо меньше работы, чем создание элемента на часть данных выше. </p>
<p>Например, давайте изменим HTML сверху только на это</p>
<pre class="prettyprint"><code class="lang-html">&lt;canvas id=&quot;c&quot;&gt;&lt;/canvas&gt;
&lt;div id=&quot;debug&quot;&gt;
  &lt;pre&gt;&lt;/pre&gt;
&lt;/div&gt;
</code></pre>
<p>И давайте создадим простой класс для управления этим <em>буфером очистки</em>.</p>
<pre class="prettyprint"><code class="lang-js">class ClearingLogger {
  constructor(elem) {
    this.elem = elem;
    this.lines = [];
  }
  log(...args) {
    this.lines.push([...args].join(&#39; &#39;));
  }
  render() {
    this.elem.textContent = this.lines.join(&#39;\n&#39;);
    this.lines = [];
  }
}
</code></pre>
<p>Тогда давайте сделаем простой пример, который каждый раз, когда мы щелкаем мышью, 
создает сетку, которая движется в произвольном направлении в течение 2 секунд.
Мы начнем с одного из примеров из статьи о  <a href="threejs-responsive.html">том, как сделать вещи отзывчивыми</a></p>
<p>Вот код, который добавляет новую сетку каждый раз, когда мы щелкаем мышью</p>
<pre class="prettyprint"><code class="lang-js">const geometry = new THREE.SphereBufferGeometry();
const material = new THREE.MeshBasicMaterial({color: &#39;red&#39;});

const things = [];

function rand(min, max) {
  if (max === undefined) {
    max = min;
    min = 0;
  }
  return Math.random() * (max - min) + min;
}

function createThing() {
  const mesh = new THREE.Mesh(geometry, material);
  scene.add(mesh);
  things.push({
    mesh,
    timer: 2,
    velocity: new THREE.Vector3(rand(-5, 5), rand(-5, 5), rand(-5, 5)),
  });
}

canvas.addEventListener(&#39;click&#39;, createThing);
</code></pre>
<p>А вот код, который перемещает созданные нами meshes, регистрирует их и удаляет их, когда у них заканчивается таймер </p>
<pre class="prettyprint"><code class="lang-js">const logger = new ClearingLogger(document.querySelector(&#39;#debug pre&#39;));

let then = 0;
function render(now) {
  now *= 0.001;  // convert to seconds
  const deltaTime = now - then;
  then = now;

  ...

  logger.log(&#39;fps:&#39;, (1 / deltaTime).toFixed(1));
  logger.log(&#39;num things:&#39;, things.length);
  for (let i = 0; i &lt; things.length;) {
    const thing = things[i];
    const mesh = thing.mesh;
    const pos = mesh.position;
    logger.log(
        &#39;timer:&#39;, thing.timer.toFixed(3), 
        &#39;pos:&#39;, pos.x.toFixed(3), pos.y.toFixed(3), pos.z.toFixed(3));
    thing.timer -= deltaTime;
    if (thing.timer &lt;= 0) {
      // remove this thing. Note we don&#39;t advance `i`
      things.splice(i, 1);
      scene.remove(mesh);
    } else {
      mesh.position.addScaledVector(thing.velocity, deltaTime);
      ++i;
    }
  }

  renderer.render(scene, camera);
  logger.render();

  requestAnimationFrame(render);
}
</code></pre>
<p>Теперь кликните мышкой в примере ниже. </p>
<p><div class="threejs_example_container">
  <div><iframe class="threejs_example" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-debug-js-clearing-logger.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-debug-js-clearing-logger.html" target="_blank">нажмите здесь, чтобы открыть в отдельном окне</a>
</div>

</p>
<h2 id="-">Параметры запроса</h2>
<p>Следует также помнить, что на веб-страницах могут передаваться данные либо через параметры запроса, либо через привязку, иногда называемую поиском и хэшем.</p>
<pre class="prettyprint"><code>https://domain/path/?query#anchor
</code></pre><p>Вы можете использовать это, чтобы сделать функции необязательными или передать параметры.</p>
<p>Например, давайте возьмем предыдущий пример и сделаем так, чтобы материал отладки отображался только в том случае, если мы добавили <code>?debug=true</code> в URL.</p>
<p>Сначала нам нужен код для разбора строки запроса</p>
<pre class="prettyprint"><code class="lang-js">/**
  * Returns the query parameters as a key/value object. 
  * Example: If the query parameters are
  *
  *    abc=123&amp;def=456&amp;name=gman
  *
  * Then `getQuery()` will return an object like
  *
  *    {
  *      abc: &#39;123&#39;,
  *      def: &#39;456&#39;,
  *      name: &#39;gman&#39;,
  *    }
  */
function getQuery() {
  return Object.fromEntries(new URLSearchParams(window.location.search).entries());
}
</code></pre>
<p>Тогда мы можем сделать элемент отладки скрытым по умолчанию</p>
<pre class="prettyprint"><code class="lang-html">&lt;canvas id=&quot;c&quot;&gt;&lt;/canvas&gt;
+&lt;div id=&quot;debug&quot; style=&quot;display: none;&quot;&gt;
  &lt;pre&gt;&lt;/pre&gt;
&lt;/div&gt;
</code></pre>
<p>Затем в коде мы читаем параметры и выбираем не скрывать отладочную информацию тогда и только тогда, когда передается <code>?debug=true</code></p>
<pre class="prettyprint"><code class="lang-js">const query = getQuery();
const debug = query.debug === &#39;true&#39;;
const logger = debug
   ? new ClearingLogger(document.querySelector(&#39;#debug pre&#39;))
   : new DummyLogger();
if (debug) {
  document.querySelector(&#39;#debug&#39;).style.display = &#39;&#39;;
}
</code></pre>
<p>Мы также создали <code>DummyLogger</code>, который ничего не делает, и решили использовать его, если <code>?debug=true</code> не был передан. </p>
<pre class="prettyprint"><code class="lang-js">class DummyLogger {
  log() {}
  render() {}
}
</code></pre>
<p>Вы можете увидеть, если мы используем этот URL:</p>
<p><a target="_blank" href="../../threejs-debug-js-params.html">threejs-debug-js-params.html</a></p>
<p>отладочной информации нет, но если мы используем этот URL:</p>
<p><a target="_blank" href="../../threejs-debug-js-params.html?debug=true">threejs-debug-js-params.html?debug=true</a></p>
<p>есть отладочная информация..</p>
<p>Несколько параметров можно передать, разделив их символом  &#39;&amp;&#39; как в <code>somepage.html?someparam=somevalue&amp;someotherparam=someothervalue</code>. 
Используя такие параметры, мы можем передавать все виды опций. Может быть <code>speed=0.01</code> чтобы замедлить наше приложение для облегчения понимания чего-либо, или <code>showHelpers=true</code>
для того, чтобы добавлять или нет помощников, которые показывают свет, тень или усечение камеры, рассматриваемые в других уроках. </p>
<h2 id="-">Научитесь пользоваться отладчиком</h2>
<p>В каждом браузере есть отладчик, в котором вы можете останавливать
вашу программу шаг за шагом и проверять все переменные. </p>
<p>Обучение тому, как использовать отладчик - слишком большая тема для этой статьи, но вот несколько ссылок </p>
<ul>
<li><a href="https://developers.google.com/web/tools/chrome-devtools/javascript/">Get Started with Debugging JavaScript in Chrome DevTools</a></li>
<li><a href="https://javascript.info/debugging-chrome">Debugging in Chrome</a></li>
<li><a href="https://hackernoon.com/tips-and-tricks-for-debugging-in-chrome-developer-tools-458ade27c7ab">Tips and Tricks for Debugging in Chrome Developer Tools</a></li>
</ul>
<h2 id="-nan-">Проверьте <code>NaN</code> в отладчике или в другом месте</h2>
<p><code>NaN</code> это сокращение от Not A Number. 
Это то, что JavaScript будет назначать в качестве значения, когда вы делаете что-то, что не имеет смысла математически. </p>
<p>В качестве простого примера</p>
<div class="threejs_center"><img class="border" src="../resources/images/nan-banana.png" style="width: 180px;"></div>


<p>Часто, когда я что-то делаю и на экране ничего не появляется,
я проверяю некоторые значения, и если я вижу <code>NaN</code>, имеет место быть, чтобы начать поиск. </p>
<p>В качестве примера, когда я впервые начал создавать путь для
<a href="threejs-load-gltf.html">статьи о загрузке файлов gLTF</a> я сделал кривую, используя класс <code>SplineCurve</code>, который создает 2D-кривую. </p>
<p>Затем я использовал эту кривую, чтобы двигать автомобили</p>
<pre class="prettyprint"><code class="lang-js">curve.getPointAt(zeroToOnePointOnCurve, car.position);
</code></pre>
<p>Внутренне <code>curve.getPointAt</code> вызывает функцию <code>set</code> для объекта, переданного в качестве второго аргумента.
В этом случае вторым аргументом является <code>car.position</code>, который является <code>Vector3</code>. 
 Функция <code>set</code> в <code>Vector3</code> требует 3 аргумента, x, y и z, но <code>SplineCurve</code> является 2D-кривой и поэтому вызывает <code>car.position.set</code> только с x и y. </p>
<p>В результате <code>car.position.set</code> устанавливает x в x, y в y, а z в <code>undefined</code>.</p>
<p>Беглый взгляд в отладчике <code>matrixWorld</code> автомобиля
показал множество значений <code>NaN</code>. </p>
<div class="threejs_center"><img class="border" src="../resources/images/debugging-nan.gif" style="width: 476px;"></div>

<p>Видя, что в матрице присутствуют <code>NaN</code> можно предположить что-то вроде <code>position</code>,
<code>rotation</code>, <code>scale</code> или какой-либо другой функции, которая влияет на то, что в матрице содержались неверные данные.
Работая в обратном направлении, было легко отследить проблему. </p>
<p>В верхней части <code>NaN</code> есть также <code>Infinity</code>, что является аналогичным признаком того, что где-то есть математическая ошибка. </p>
<h2 id="-">Смотри в коде!</h2>
<p>THREE.js является открытым исходным кодом. Не бойтесь заглянуть внутрь кода! Вы можете заглянуть внутрь на  <a href="https://github.com/mrdoob/three.js">github</a>.
Вы также можете заглянуть внутрь, войдя в функции в отладчике. 
Когда вы сделаете это, рассмотрите возможность использования <code>three.js</code> вместо более распространенного <code>three.min.js</code>. 
<code>three.min.js</code> - уменьшенная, сжатая и поэтому уменьшенная для загрузки версия. <code>three.js</code> - более крупная, но более простая в отладке версия. 
Я часто переключаю свой код на использование <code>three.js</code>, чтобы пройтись по коду и посмотреть, что происходит. </p>
<h2 id="-requestanimationframe-">Поместите <code>requestAnimationFrame</code> внизу вашей функции рендеринга.</h2>
<p>Я часто вижу эту закономерность</p>
<pre class="prettyprint"><code class="lang-js">function render() {
   requestAnimationFrame(render);

   // -- do stuff --

   renderer.render(scene, camera);
}
requestAnimationFrame(render);
</code></pre>
<p>Я бы предложил поместить вызов <code>requestAnimationFrame</code> внизу, как в</p>
<pre class="prettyprint"><code class="lang-js">function render() {
   // -- do stuff --

   renderer.render(scene, camera);

   requestAnimationFrame(render);
}
requestAnimationFrame(render);
</code></pre>
<p>Основная причина в том, что ваш код остановится – возникновение ошибки. 
Помещение <code>requestAnimationFrame</code> вверху означает, что ваш код будет продолжать работать, 
даже если у вас есть ошибка, так как вы уже запросили другой кадр.  Лучше найти эти ошибки, чем игнорировать их.
Они могут быть причиной того, что что-то не появляется так, как вы ожидаете, но если ваш код не остановится, вы можете даже не заметить. </p>
<h2 id="-">Проверьте свои единицы!</h2>
<p>Это в основном означает понимание, например, когда использовать градусы, а когда использовать радианы. 
К сожалению, THREE.js не использует везде одинаковые единицы измерения. Всё что в 
поле зрении камеры - в градусах. Все остальные углы указаны в радианах. </p>
<p>Другое место, на которое стоит обратить внимание - ваши единицы измерения. 
До недавнего времени 3D-приложения могли выбирать любую единицу измерения, который они хотели. 
Одно приложение может выбрать 1 единицу = 1 см. Другой может выбрать 1 единицу = 1 фут. 
На самом деле все еще верно, что вы можете выбрать любые единицы измерения для определенных приложений. 
Тем не менее, THREE.js предполагает 1 единицу = 1 метр. Это важно для таких вещей, как физический рендеринг с использованием метров для вычисления световых эффектов. 
Это также важно для AR и VR, которые должны иметь дело с реальными устройствами, такими как ваш телефон или как контроллеры VR. </p>
<h2 id="-minimal-complete-verifiable-example-stack-overflow">Создание <em>Minimal, Complete, Verifiable, Example</em> для Stack Overflow</h2>
<p>Если вы решите задать вопрос о THREE.js,
вам почти всегда необходимо предоставить MCVE, что означает «Минимальный, Полный, Проверяемый, Пример». </p>
<p><strong>Минимальная</strong> часть важна. Допустим, у вас возникла проблема с перемещением пути в последнем примере <a href="threejs-load-gltf.html">загрузки статьи gLTF</a>. 
Этот пример имеет много частей. Включите их в список </p>
<ol>
<li>A bunch of HTML</li>
<li>Some CSS</li>
<li>Lights</li>
<li>Shadows</li>
<li>DAT.gui code to manipulate shadows</li>
<li>Code to load a .GLTF file</li>
<li>Code to resize the canvas.</li>
<li>Code to move the cars along paths</li>
</ol>
<p>Это довольно много. Если ваш вопрос касается только пути, вы можете удалить большую часть HTML, 
так как вам нужен только тег <code>&lt;canvas&gt;</code> и <code>&lt;script&gt;</code> для THREE.js. Вы можете удалить CSS и код изменения размера.
Вы можете удалить код .GLTF, потому что вам нужен только путь.
Вы можете удалить источники света и тени с помощью <code>MeshBasicMaterial</code>. 
Вы, конечно, можете удалить код <code>DAT.gui</code>. Код создает плоскость с текстурой. Было бы проще использовать <code>GridHelper</code>. 
Наконец, если наш вопрос касается перемещения объектов по пути,
мы могли бы просто использовать кубы на пути вместо загруженных моделей автомобилей. </p>
<p>Вот более минимальный пример, учитывающий все вышеперечисленное. Он сократился с 271 строки до 135. 
Мы могли бы подумать об уменьшении его еще больше, упрощая наш путь. Возможно, путь с 3 или 4 точками будет работать так же хорошо, как и наш путь с 21 точкой. </p>
<p><div class="threejs_example_container">
  <div><iframe class="threejs_example" style=" " src="/threejs/resources/editor.html?url=/threejs/lessons/..%2Fthreejs-debugging-mcve.html"></iframe></div>
  <a class="threejs_center" href="/threejs/lessons/../threejs-debugging-mcve.html" target="_blank">нажмите здесь, чтобы открыть в отдельном окне</a>
</div>

</p>
<p>Я сохранил <code>OrbitController</code> только потому, что полезно перемещать камеру и выяснять, что происходит, но в зависимости от вашей проблемы вы также можете удалить это.</p>
<p>Лучшее в создании MCVE - это то, что мы часто решаем нашу собственную проблему. Процесс удаления всего, что не нужно, и делая наименьший пример, мы решаем проблему, чем наоборот. </p>
<p>Вдобавок ко всему, с уважением относимся к тому времени, за которое люди будут смотреть на ваш код в Stack Overflow. 
Делая минимальный пример, вы облегчаете им задачу. Вы также будете учиться в процессе. </p>
<p>Также важно, когда вы отправляете свой вопрос в Stack Overflow, <strong>поместите свой код <a href="https://stackoverflow.blog/2014/09/16/introducing-runnable-javascript-css-and-html-code-snippets/">во фрагмент</a>.</strong>
Конечно, вы можете использовать JSFiddle, Codepen или аналогичный сайт для тестирования MCVE, но как только вы действительно отправите свой вопрос в Stack Overflow, 
вам потребуется поместить код для воспроизведения вашей проблемы <strong>в сам вопрос</strong>. 
Делая фрагмент, вы удовлетворяете это требование. </p>
<p>Также обратите внимание, что все живые примеры на этом сайте должны работать как фрагменты. Просто скопируйте части HTML, CSS и JavaScript в соответствующие части 
<a href="https://stackoverflow.blog/2014/09/16/introducing-runnable-javascript-css-and-html-code-snippets/">редактора фрагментов</a>.
Просто не забудьте попытаться удалить части, не относящиеся к вашей проблеме, и постарайтесь сделать свой код минимально необходимым. </p>
<p>Следуйте этим советам, и у вас будет гораздо больше шансов получить помощь по вашей проблеме.</p>
<h2 id="-meshbasicmaterial-">Используйте <code>MeshBasicMaterial</code></h2>
<p>Поскольку <code>MeshBasicMaterial</code> не использует источники света, это один из способов устранения причин, по которым что-то может не отображаться. 
Если ваши объекты отображаются с использованием <code>MeshBasicMaterial</code>, но не с какими-либо материалами, которые вы использовали, то вы знаете,
что проблема, скорее всего, связана с материалами или источниками света, а не с какой-либо другой частью кода. </p>
<h2 id="-near-far-">Проверьте <code>near</code> и <code>far</code> настройки вашей камеры</h2>
<p><code>PerspectiveCamera</code> имеет ближние и дальние настройки, которые описаны в 
<a href="threejs-cameras.html">статье о камерах</a>. Убедитесь, что они установлены в соответствии с пространством, в котором находятся ваши объекты.
Возможно, даже просто <em>временно</em> установите для них что-то большое, например, <code>near</code> = 0,001 и <code>far</code> = 1000000.
Скорее всего, у вас возникнут проблемы с разрешением по глубине, но вы по крайней мере сможете увидеть ваши объекты, если они находятся перед камерой. </p>
<h2 id="-">Проверьте вашу сцену перед камерой</h2>
<p>Иногда вещи не появляются, потому что они не перед камерой.Если ваша камера не управляема попробуйте добавить управление камерой,
как <code>OrbitControlle</code>r так что вы можете посмотреть вокруг и найти вашу сцену.  Или, попробовать кадрирование сцены, используя код, который транслируется в <a href="threejs-load-obj.html">этой статье</a>.
Этот код находит размер части сцены, а затем перемещает камеру и регулирует <code>near</code> и <code>far</code> настройки, чтобы сделать его видимым. Затем можно заглянуть в
отладчик или добавить некоторые в <code>console.log</code> сообщения для печати размера и центра сцены.</p>
<h2 id="-">Поставь что-нибудь перед сценой камеры</h2>
<p>Это просто еще один способ сказать, если все остальное терпит неудачу начнем с того, что работает, а потом потихоньку будем добавлять код обратно. 
Если вы получаете пустой экран, то попробуйте поместить что-то прямо перед камерой. Сделать сферу или поле, дать ему простой материал,
как <code>MeshBasicMaterial</code> и убедитесь, что вы можете сделать это на экране. 
Затем начать добавлять код немного назад во времени и тестирования.
В конце концов вы либо найдёте вашу ошибку, или вы найдете пути её решения. </p>
<hr>
<p>Это были несколько советов для отладки JavaScript. Давайте перейдём к <a href="threejs-debugging-glsl.html">некоторым советам для отладки на GLSL</a>.</p>

    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/threejs/lessons/threejs-debugging-javascript.html" >English</a>
    <option value="/threejs/lessons/fr/threejs-debugging-javascript.html" >Français</a>
    <option value="/threejs/lessons/kr/threejs-debugging-javascript.html" >한국어</a>
    <option value="/threejs/lessons/ru/threejs-debugging-javascript.html" selected>Русский</a>
    <option value="/threejs/lessons/zh_cn/threejs-debugging-javascript.html" >中文</a>
</select>


        <div id="toc">
          <ul>  <li>Введение</li>
        <ul>
          <li><a href="/threejs/lessons/ru/threejs-fundamentals.html">Базовые принципы</a></li>
<li><a href="/threejs/lessons/ru/threejs-responsive.html">Адаптивный дизайн</a></li>
<li><a href="/threejs/lessons/ru/threejs-prerequisites.html">Необходимые условия</a></li>
<li><a href="/threejs/lessons/ru/threejs-setup.html">Настройка</a></li>
        </ul>
  <li>Фунаментальные понятия</li>
        <ul>
          <li><a href="/threejs/lessons/ru/threejs-primitives.html">Примитивы</a></li>
<li><a href="/threejs/lessons/ru/threejs-scenegraph.html">Граф сцены</a></li>
<li><a href="/threejs/lessons/ru/threejs-materials.html">Материалы</a></li>
<li><a href="/threejs/lessons/ru/threejs-textures.html">Текстуры</a></li>
<li><a href="/threejs/lessons/ru/threejs-lights.html">Освещение</a></li>
<li><a href="/threejs/lessons/ru/threejs-cameras.html">Камера</a></li>
<li><a href="/threejs/lessons/ru/threejs-shadows.html">Тени</a></li>
<li><a href="/threejs/lessons/ru/threejs-fog.html">Туман</a></li>
<li><a href="/threejs/lessons/ru/threejs-rendertargets.html">Цели рендеринга</a></li>
<li><a href="/threejs/lessons/ru/threejs-custom-geometry.html">Пользовательская Geometry</a></li>
<li><a href="/threejs/lessons/ru/threejs-custom-buffergeometry.html">Пользовательская BufferGeometry</a></li>
        </ul>
  <li>Советы</li>
        <ul>
          <li><a href="/threejs/lessons/ru/threejs-rendering-on-demand.html">Рендеринг по требованию</a></li>
<li><a href="/threejs/lessons/ru/threejs-debugging-javascript.html">Отладка JavaScript</a></li>
<li><a href="/threejs/lessons/ru/threejs-debugging-glsl.html">Отладка GLSL</a></li>
<li><a href="/threejs/lessons/ru/threejs-tips.html#screenshot">Taking a screenshot</a></li>
<li><a href="/threejs/lessons/ru/threejs-tips.html#preservedrawingbuffer">Prevent the Canvas Being Cleared</a></li>
<li><a href="/threejs/lessons/ru/threejs-tips.html#tabindex">Get Keyboard Input From a Canvas</a></li>
<li><a href="/threejs/lessons/ru/threejs-tips.html#transparent-canvas">Make the Canvas Transparent</a></li>
<li><a href="/threejs/lessons/ru/threejs-tips.html#html-background">Use three.js as Background in HTML</a></li>
        </ul>
  <li>Optimization</li>
        <ul>
          <li><a href="/threejs/lessons/ru/threejs-optimize-lots-of-objects.html">Optimizing Lots of Objects</a></li>
<li><a href="/threejs/lessons/ru/threejs-optimize-lots-of-objects-animated.html">Optimizing Lots of Objects Animated</a></li>
<li><a href="/threejs/lessons/ru/threejs-offscreencanvas.html">Using OffscreenCanvas in a Web Worker</a></li>
        </ul>
  <li>Решения</li>
        <ul>
          <li><a href="/threejs/lessons/ru/threejs-load-obj.html">Load an .OBJ file</a></li>
<li><a href="/threejs/lessons/ru/threejs-load-gltf.html">Load a .GLTF file</a></li>
<li><a href="/threejs/lessons/ru/threejs-backgrounds.html">Add a Background or Skybox</a></li>
<li><a href="/threejs/lessons/ru/threejs-transparency.html">How to Draw Transparent Objects</a></li>
<li><a href="/threejs/lessons/ru/threejs-multiple-scenes.html">Несколько холстов, несколько сцен</a></li>
<li><a href="/threejs/lessons/ru/threejs-picking.html">Picking Objects with the mouse</a></li>
<li><a href="/threejs/lessons/ru/threejs-post-processing.html">Post Processing</a></li>
<li><a href="/threejs/lessons/ru/threejs-post-processing-3dlut.html">Applying a LUT File for effects</a></li>
<li><a href="/threejs/lessons/ru/threejs-shadertoy.html">Using Shadertoy shaders</a></li>
<li><a href="/threejs/lessons/ru/threejs-align-html-elements-to-3d.html">Aligning HTML Elements to 3D</a></li>
<li><a href="/threejs/lessons/ru/threejs-indexed-textures.html">Using Indexed Textures for Picking and Color</a></li>
<li><a href="/threejs/lessons/ru/threejs-canvas-textures.html">Using A Canvas for Dynamic Textures</a></li>
<li><a href="/threejs/lessons/ru/threejs-billboards.html">Billboards and Facades</a></li>
<li><a href="/threejs/lessons/ru/threejs-cleanup.html">Freeing Resources</a></li>
<li><a href="/threejs/lessons/ru/threejs-voxel-geometry.html">Making Voxel Geometry (Minecraft)</a></li>
<li><a href="/threejs/lessons/ru/threejs-game.html">Start making a Game.</a></li>
        </ul>
  <li>WebVR</li>
        <ul>
          <li><a href="/threejs/lessons/ru/threejs-webvr.html">VR - Basics</a></li>
<li><a href="/threejs/lessons/ru/threejs-webvr-look-to-select.html">VR - Look To Select</a></li>
<li><a href="/threejs/lessons/ru/threejs-webvr-point-to-select.html">VR - Point To Select</a></li>
        </ul>
  <li>Ссылки</li>
        <ul>
          <li><a href="/threejs/lessons/ru/threejs-material-table.html">Таблица материалов</a></li>
        </ul></ul>
<ul>
  <li><a href="https://github.com/gfxfundamentals/threejsfundamentals">github</a></li>
  <li><a href="https://threejs.org">three.js</a></li>
  <li><a href="https://threejs.org/docs/">three.js docs</a></li>
</ul>

        </div>
    </div>
    <div class="lesson-comments">
        <div>Вопросы? <a href="http://stackoverflow.com/questions/tagged/three.js">Спросите на stackoverflow</a>.</div>
        <div>Нашли ошибку? <a href="http://github.com/gfxfundamentals/threejsfundamentals/issues">Создайте issue на github</a>.</div>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'threejsfundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'Three.js Отладка JavaScript';
            var disqus_title = 'Three.js Отладка JavaScript';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("threejsfundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script src="/3rdparty/jquery-3.3.1.slim.min.js"></script>
<script src="/threejs/lessons/resources/prettify.js"></script>
<script src="/threejs/lessons/resources/lesson.js"></script>
<script>
(function() {
  if (window.location.hostname.indexOf("threejsfundamentals.org") < 0) {
      return;
  }

  function addScript(src, fn) {
    const script = document.createElement('script');
    const firstScript = document.getElementsByTagName('script')[0];
    script.async = true;
    script.defer = true;
    if (fn) {
      script.addEventListener('load', fn);
    }
    script.src = src;
    firstScript.parentNode.insertBefore(script, firstScript);
  }

  addScript('//cdn.webglstats.com/stat.js');
  addScript('https://www.googletagmanager.com/gtag/js?id=UA-120733518-1', () => {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-120733518-1');
  });
}());
</script>


</html>



